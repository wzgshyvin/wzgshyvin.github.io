<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ACM模板-稳赚个人版 | V1n</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="ACM板子" />
  
  
  
  
  <meta name="description" content="稳赚又丑又T的板子">
<meta property="og:type" content="article">
<meta property="og:title" content="ACM模板-稳赚个人版">
<meta property="og:url" content="http://wzgshyvin.github.io/2020/01/01/ACM%E6%A8%A1%E6%9D%BF-%E7%A8%B3%E8%B5%9A%E4%B8%AA%E4%BA%BA%E7%89%88/index.html">
<meta property="og:site_name" content="V1n">
<meta property="og:description" content="稳赚又丑又T的板子">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://s2.ax1x.com/2020/03/02/3ROELR.jpg">
<meta property="article:published_time" content="2020-01-01T12:36:36.000Z">
<meta property="article:modified_time" content="2021-01-26T16:38:24.090Z">
<meta property="article:author" content="V1n">
<meta property="article:tag" content="ACM">
<meta property="article:tag" content="板子">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.ax1x.com/2020/03/02/3ROELR.jpg">
  
    <link rel="alternate" href="/atom.xml" title="V1n" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  
<link rel="stylesheet" href="/css/style.css">


  
<script src="/js/jquery-3.1.1.min.js"></script>


  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >
  <link rel="stylesheet" href="/css/fashion.css" >
  <link rel="stylesheet" href="/css/glyphs.css" >




  <body data-spy="scroll" data-target="#toc" data-offset="50">


  


<header id="allheader" class="site-header" role="banner" 
   >
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="V1n" rel="home"> V1n </a>
            
          </h1>
          
          
            <div class="site-description">I have suffered and despaired and known death and I am glad that I am in this great world.</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows"  style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/categories">Categories</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/tags">Tags</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/Friends">friends</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class="" href="/about">About</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-ACM模板-稳赚个人版" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
<div class="article-gallery">
  <div class="article-gallery-photos">
    
      <a class="article-gallery-img fancybox" target="_blank" href="https://s2.ax1x.com/2020/03/02/3ROELR.jpg" rel="gallery_cklv03ibp006rfgum9uu0ctmr noopener">
        <img src="https://s2.ax1x.com/2020/03/02/3ROELR.jpg" itemprop="image">
      </a>
    
  </div>
</div>

    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      ACM模板-稳赚个人版
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2020/01/01/ACM%E6%A8%A1%E6%9D%BF-%E7%A8%B3%E8%B5%9A%E4%B8%AA%E4%BA%BA%E7%89%88/" class="article-date">
	  <time datetime="2020-01-01T12:36:36.000Z" itemprop="datePublished">January 1, 2020</time>
	</a>

      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/w/">w</a>
 
      
	<span id="busuanzi_container_page_pv">
	  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
	</span>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>稳赚又丑又T的板子</p>
<a id="more"></a>
<h2 id="头文件"><a href="#头文件" class="headerlink" title="头文件"></a>头文件</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> pf printf</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> sc(x) scanf(<span class="meta-string">&quot;%d&quot;</span>, &amp;x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scs(x) scanf(<span class="meta-string">&quot;%s&quot;</span>, x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scd(x) scanf(<span class="meta-string">&quot;%lf&quot;</span>, &amp;x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> scl(x) scanf(<span class="meta-string">&quot;%lld&quot;</span>, &amp;x)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mst(a,x) memset(a, x, sizeof(a))</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rep(i,s,e) for(int i=(s); i&lt;(e); ++i)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> dep(i,e,s) for(int i=(e); i&gt;=(s); --i)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span>&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; pii;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-10</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br></pre></td></tr></table></figure>
<h2 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h2><h3 id="char函数"><a href="#char函数" class="headerlink" title="char函数"></a>char函数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> s1[maxn], s2[maxn];</span><br><span class="line"><span class="keyword">char</span> c; <span class="keyword">int</span> n;</span><br><span class="line"><span class="built_in">strcat</span>(s1,s2); <span class="comment">// s1+=s2;</span></span><br><span class="line"><span class="built_in">strncat</span>(s1,s2,n); <span class="comment">// 加上s2的前n个字符</span></span><br><span class="line"><span class="built_in">strchr</span>(s1,c); <span class="comment">// 返回s1中第一次出现c的位置</span></span><br><span class="line">strnchr(s1,c); <span class="comment">// 返回s1中最后一次出现c的位置</span></span><br><span class="line"><span class="built_in">strstr</span>(s1,s2); <span class="comment">// 返回s1中第一次出现s2的位置</span></span><br><span class="line"><span class="built_in">strcmp</span>(s1,s2); <span class="comment">// 比较 能比大小的</span></span><br><span class="line"><span class="built_in">strncmp</span>(s1,s2,n); <span class="comment">// 比前n个</span></span><br><span class="line"><span class="built_in">strcpy</span>(s1,s2); <span class="comment">// s1=s2;</span></span><br><span class="line"><span class="built_in">strncpy</span>(s1,s2,n); <span class="comment">// s1为s2前n个字符</span></span><br></pre></td></tr></table></figure>
<h3 id="string函数"><a href="#string函数" class="headerlink" title="string函数"></a>string函数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">string</span> s1,s2;</span><br><span class="line"><span class="keyword">int</span> pos,len; <span class="keyword">char</span> c;</span><br><span class="line">s1.find(s2);</span><br><span class="line"><span class="comment">// 返回值为s2第一次出现在s1的位置 </span></span><br><span class="line"><span class="comment">// 若s2不是s1子串返回 string::npos</span></span><br><span class="line">s1.replace(pos,len,s2);</span><br><span class="line"><span class="comment">// s1从pos位开始长度len的子串替换成s2</span></span><br><span class="line">s1.substr(pos,len);</span><br><span class="line">s1.insert(pos,s2);</span><br><span class="line">s1.insert(pos,s2,len);</span><br><span class="line"><span class="comment">// 插入s2的前len个字符</span></span><br><span class="line">s1.insert(pos,len,c);</span><br><span class="line"><span class="comment">// 插入len个c</span></span><br><span class="line">s1.erase(pos,len);</span><br></pre></td></tr></table></figure>
<h3 id="字典树"><a href="#字典树" class="headerlink" title="字典树"></a>字典树</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 数组版</span></span><br><span class="line"><span class="keyword">int</span> trie[maxn][<span class="number">26</span>];</span><br><span class="line"><span class="keyword">int</span> cnt[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    rep(i,<span class="number">0</span>,len)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(!trie[u][tmp])&#123;</span><br><span class="line">            trie[u][tmp]=++n;</span><br><span class="line">            cnt[n]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> cnt[trie[u][tmp]]++;</span><br><span class="line">        u=trie[u][tmp];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">char</span> *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> u=<span class="number">0</span>,len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    rep(i,<span class="number">0</span>,len)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(!trie[u][tmp]) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        u=trie[u][tmp];</span><br><span class="line">    &#125; <span class="keyword">return</span> cnt[u];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 指针版</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">trie</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> cnt; trie *next[<span class="number">26</span>];</span><br><span class="line">    trie()&#123; cnt=<span class="number">0</span>; rep(i,<span class="number">0</span>,<span class="number">26</span>) next[i]=<span class="literal">NULL</span>; &#125;</span><br><span class="line">&#125;;</span><br><span class="line">trie *root,*p;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">    p=root; <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    rep(i,<span class="number">0</span>,len)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;next[tmp]==<span class="literal">NULL</span>) p-&gt;next[tmp]=<span class="keyword">new</span> trie();</span><br><span class="line">        p=p-&gt;next[tmp]; p-&gt;cnt++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">    p=root;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    rep(i,<span class="number">0</span>,len)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span> (p-&gt;next[tmp] == <span class="literal">NULL</span>) </span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        p=p-&gt;next[tmp];</span><br><span class="line">    &#125; <span class="keyword">return</span> p-&gt;cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> nex[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getnext</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">-1</span>,len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    nex[<span class="number">0</span>]=<span class="number">-1</span>; <span class="keyword">while</span>(i&lt;len)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j==<span class="number">-1</span>||s[i]==s[j])&#123;</span><br><span class="line">            i++; j++; nex[i]=j;</span><br><span class="line">        &#125; <span class="keyword">else</span> j=nex[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">kmp</span><span class="params">(<span class="keyword">char</span> *s1,<span class="keyword">char</span> *s2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>; getnext(s2);</span><br><span class="line">    <span class="keyword">int</span> len1=<span class="built_in">strlen</span>(s1),len2=<span class="built_in">strlen</span>(s2);</span><br><span class="line">    <span class="keyword">while</span>(i&lt;len1&amp;&amp;j&lt;len2)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j==<span class="number">-1</span>||s1[i]==s2[j])&#123; i++; j++; &#125;</span><br><span class="line">        <span class="keyword">else</span> j=nex[j];</span><br><span class="line">        <span class="keyword">if</span>(j==len2) <span class="keyword">return</span> i-j+<span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 关于next数组应用如</span></span><br><span class="line"><span class="comment">if(nex[pos]&amp;&amp;pos%(pos-nex[pos])==0)</span></span><br><span class="line"><span class="comment">即有s的前pos位有(pos/(pos-nex[pos]))个长度为pos-nex[pos]的前缀*/</span></span><br><span class="line"><span class="comment">//求总前缀数 dp</span></span><br><span class="line">rep(i,<span class="number">1</span>,len+<span class="number">1</span>)&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp=nex[i];</span><br><span class="line">    <span class="keyword">while</span>(tmp) sum++,tmp=nex[tmp];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 根据nex求s1和s2尾头衔接重叠部分</span></span><br><span class="line">s2+=<span class="string">&#x27;*&#x27;</span>+s1; <span class="keyword">int</span> q=getnext(s2); ans=s2.substr(<span class="number">0</span>,q);</span><br><span class="line"><span class="comment">// 套娃nex求前缀和后缀相同部分</span></span><br><span class="line"><span class="comment">// on预处理求每个前缀在字符串中出现了几次</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getnum</span><span class="params">(<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">    rep(i,<span class="number">1</span>,len+<span class="number">1</span>) num[nex[i]]++; </span><br><span class="line">    dep(i,len,<span class="number">1</span>) num[nex[i]]+=num[i];</span><br><span class="line">    <span class="keyword">int</span> t=len; <span class="keyword">while</span>(t)&#123; vv.push_back(t),t=nex[t]; &#125;</span><br><span class="line">    pf(<span class="string">&quot;%d\n&quot;</span>,vv.size()); sort(vv.begin(),vv.end());</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> x:vv) pf(<span class="string">&quot;%d %d\n&quot;</span>,x,num[x]+<span class="number">1</span>); <span class="comment">// 长度和次数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="EXKMP"><a href="#EXKMP" class="headerlink" title="EXKMP"></a>EXKMP</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> nex[maxn], extend[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getnext</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> aa=<span class="number">0</span>,len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    nex[<span class="number">0</span>]=len;</span><br><span class="line">    <span class="keyword">while</span>(aa&lt;len<span class="number">-1</span>&amp;&amp;s[aa]==s[aa+<span class="number">1</span>]) aa++;</span><br><span class="line">    nex[<span class="number">1</span>]=aa; aa=<span class="number">1</span>;</span><br><span class="line">    rep(i,<span class="number">2</span>,len)&#123;</span><br><span class="line">        <span class="keyword">int</span> p=aa+nex[aa]<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> l=nex[i-aa];</span><br><span class="line">        <span class="keyword">if</span>(i+l<span class="number">-1</span>&gt;=p)&#123;</span><br><span class="line">            <span class="keyword">int</span> j=(p-i+<span class="number">1</span>)&gt;<span class="number">0</span>?p-i+<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(i+j&lt;len&amp;&amp;s[i+j]==s[j]) j++;</span><br><span class="line">            nex[i]=j; aa=i;</span><br><span class="line">        &#125; <span class="keyword">else</span> nex[i]=l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getextend</span><span class="params">(<span class="keyword">char</span>* s1,<span class="keyword">char</span>* s2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> aa=<span class="number">0</span>; mst(nex,<span class="number">0</span>); getnext(s2);</span><br><span class="line">    <span class="keyword">int</span> len1=<span class="built_in">strlen</span>(s1),len2=<span class="built_in">strlen</span>(s2);</span><br><span class="line">    <span class="keyword">int</span> minl=min(len1,len2);</span><br><span class="line">    <span class="keyword">while</span>(aa&lt;minl&amp;&amp;s1[aa]==s2[aa]) aa++;</span><br><span class="line">    extend[<span class="number">0</span>]=aa; aa=<span class="number">0</span>;</span><br><span class="line">    rep(i,<span class="number">1</span>,len1)&#123;</span><br><span class="line">        <span class="keyword">int</span> p=aa+extend[aa]<span class="number">-1</span>,l=nex[i-aa];</span><br><span class="line">        <span class="keyword">if</span>(i+l<span class="number">-1</span>&gt;=p)&#123;</span><br><span class="line">            <span class="keyword">int</span> j=(p-i+<span class="number">1</span>)&gt;<span class="number">0</span>?p-i+<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(i+j&lt;len1&amp;&amp;j&lt;len2&amp;&amp;s1[i+j]==s2[j]) j++;</span><br><span class="line">            extend[i]=j; aa=i;</span><br><span class="line">        &#125; <span class="keyword">else</span> extend[i]=l;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="马拉车"><a href="#马拉车" class="headerlink" title="马拉车"></a>马拉车</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> che[<span class="number">2</span>*maxn];</span><br><span class="line"><span class="keyword">char</span> s[maxn],ma[<span class="number">2</span>*maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">manacher</span><span class="params">(<span class="keyword">char</span>* s,<span class="keyword">int</span> len0)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="number">0</span>; ma[len++]=<span class="string">&#x27;$&#x27;</span>; ma[len++]=<span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">    rep(i,<span class="number">0</span>,len0) ma[len++]=s[i],ma[len++]=<span class="string">&#x27;#&#x27;</span>;</span><br><span class="line">    ma[len]=<span class="number">0</span>; <span class="keyword">int</span> maxx=<span class="number">0</span>,num=<span class="number">0</span>;</span><br><span class="line">    rep(i,<span class="number">0</span>,len)&#123;</span><br><span class="line">        che[i]=maxx&gt;i?min(che[<span class="number">2</span>*num-i],maxx-i):<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(ma[i+che[i]]==ma[i-che[i]]) che[i]++;</span><br><span class="line">        <span class="keyword">if</span>(i+che[i]&gt;maxx) maxx=i+che[i],num=i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="AC自动机"><a href="#AC自动机" class="headerlink" title="AC自动机"></a>AC自动机</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 计每个单词有无出现 注释里写记单词数的 以*开头</span></span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    node* next[<span class="number">26</span>]; <span class="comment">// 最大100够的 所有题</span></span><br><span class="line">    node* fail;</span><br><span class="line">    <span class="keyword">int</span> end; <span class="comment">// 在单词末尾做标记</span></span><br><span class="line">    <span class="comment">//* int id; </span></span><br><span class="line">    node()&#123;</span><br><span class="line">        end=<span class="number">0</span>; <span class="comment">//* id=0; </span></span><br><span class="line">        fail=<span class="number">0</span>;</span><br><span class="line">        mst(next,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">node* root;</span><br><span class="line"><span class="comment">// 建字典树</span></span><br><span class="line"><span class="comment">//* int tot;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">    node* p=root;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    rep(i,<span class="number">0</span>,len)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">if</span>(p-&gt;next[tmp]==<span class="literal">NULL</span>) p-&gt;next[tmp]=<span class="keyword">new</span> node();</span><br><span class="line">        p=p-&gt;next[tmp];</span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;end++;</span><br><span class="line">    <span class="comment">//* p-&gt;id=++tot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">queue</span>&lt;node*&gt;q;</span><br><span class="line"><span class="comment">// fail数组：root指向NULL 没出现过的指向root 出现过的指向前一个</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getfail</span><span class="params">()</span></span>&#123;</span><br><span class="line">    root-&gt;fail=<span class="literal">NULL</span>;</span><br><span class="line">    q.push(root);</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        node* fr=q.front(); q.pop();</span><br><span class="line">        rep(i,<span class="number">0</span>,<span class="number">26</span>) <span class="keyword">if</span>(fr-&gt;next[i])&#123;</span><br><span class="line">            node* tem=fr-&gt;fail;</span><br><span class="line">            <span class="keyword">while</span>(tem)&#123;</span><br><span class="line">                <span class="keyword">if</span>(tem-&gt;next[i])&#123;</span><br><span class="line">                    fr-&gt;next[i]-&gt;fail=tem-&gt;next[i];</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125; tem=tem-&gt;fail;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(tem==<span class="literal">NULL</span>) fr-&gt;next[i]-&gt;fail=root;</span><br><span class="line">            q.push(fr-&gt;next[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//* num[maxn], mark[maxn], cnt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ac_auto</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">    node* p=root;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    rep(i,<span class="number">0</span>,len)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        <span class="keyword">while</span>(!p-&gt;next[tmp] &amp;&amp; p!=root) p=p-&gt;fail;</span><br><span class="line">        p=p-&gt;next[tmp];</span><br><span class="line">        <span class="keyword">if</span>(!p) p=root;</span><br><span class="line">        node* tem=p;</span><br><span class="line">        <span class="keyword">while</span>(tem!=root)&#123;</span><br><span class="line">            <span class="keyword">if</span>(tem-&gt;end&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">                ans+=tem-&gt;end;</span><br><span class="line">                tem-&gt;end=<span class="number">-1</span>; <span class="comment">// 出现过了第二次遇到不再统计</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">            <span class="comment">/* if(tem-&gt;id)&#123;</span></span><br><span class="line"><span class="comment">                *if(!mark[tem-&gt;id]) </span></span><br><span class="line"><span class="comment">                    *num[cnt++]=tem-&gt;id;</span></span><br><span class="line"><span class="comment">                // num按在s串中出现顺序存id</span></span><br><span class="line"><span class="comment">                *mark[tem-&gt;id]++;</span></span><br><span class="line"><span class="comment">                //mark存出现与否 顺便存次数</span></span><br><span class="line"><span class="comment">            &#125;*/</span></span><br><span class="line">            tem=tem-&gt;fail;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 虽然指针版怪弱智的 但舍不得了</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ACAM</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> ch[maxn][<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">int</span> tot,num[maxn],nex[maxn];</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        tot=<span class="number">1</span>; rep(i,<span class="number">0</span>,<span class="number">26</span>) ch[<span class="number">0</span>][i]=<span class="number">1</span>;</span><br><span class="line">        rep(i,<span class="number">0</span>,<span class="number">26</span>) ch[<span class="number">1</span>][i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span>* s,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=<span class="built_in">strlen</span>(s+<span class="number">1</span>),p=<span class="number">1</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> tmp=s[i]-<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">            <span class="keyword">if</span>(!ch[p][tmp])&#123;</span><br><span class="line">                ch[p][tmp]=++tot;</span><br><span class="line">                rep(j,<span class="number">0</span>,<span class="number">26</span>) ch[tot][j]=<span class="number">0</span>;</span><br><span class="line">                num[tot]=<span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p=ch[p][tmp];</span><br><span class="line">        &#125; num[p]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getfail</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt;q; q.push(<span class="number">1</span>); nex[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">            <span class="keyword">int</span> fr=q.front(); q.pop();</span><br><span class="line">            rep(i,<span class="number">0</span>,<span class="number">26</span>) <span class="keyword">if</span>(!ch[fr][i]) ch[fr][i]=ch[nex[fr]][i];</span><br><span class="line">            <span class="keyword">else</span> nex[ch[fr][i]]=ch[nex[fr]][i],q.push(ch[fr][i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">query</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=<span class="built_in">strlen</span>(s+<span class="number">1</span>),p=<span class="number">1</span>; cnt=<span class="number">0</span>; </span><br><span class="line">        rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> tmp=s[i]-<span class="string">&#x27;a&#x27;</span>,k=ch[p][tmp];</span><br><span class="line">            <span class="keyword">while</span>(k&gt;<span class="number">1</span>) ...,k=nex[k];</span><br><span class="line">            p=ch[p][tmp];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;ac;</span><br></pre></td></tr></table></figure>
<h3 id="后缀数组"><a href="#后缀数组" class="headerlink" title="后缀数组"></a>后缀数组</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> s[maxn];</span><br><span class="line"><span class="keyword">int</span> sa[maxn],rk[maxn];</span><br><span class="line"><span class="keyword">int</span> height[maxn];</span><br><span class="line"><span class="keyword">int</span> t1[maxn],t2[maxn],c[maxn];</span><br><span class="line"><span class="keyword">int</span> best[<span class="number">20</span>][maxn];</span><br><span class="line"><span class="keyword">char</span> ss[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getsa</span><span class="params">(<span class="keyword">int</span> *s,<span class="keyword">int</span> n,<span class="keyword">int</span> m)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> *x=t1,*y=t2;</span><br><span class="line">    rep(i,<span class="number">0</span>,m) c[i]=<span class="number">0</span>; </span><br><span class="line">    rep(i,<span class="number">0</span>,n) c[x[i]=s[i]]++;</span><br><span class="line">    rep(i,<span class="number">1</span>,m) c[i]+=c[i<span class="number">-1</span>];</span><br><span class="line">    dep(i,n<span class="number">-1</span>,<span class="number">0</span>) sa[--c[x[i]]]=i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k&lt;&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> p=<span class="number">0</span>;</span><br><span class="line">        rep(i,n-k,n) y[p++]=i;</span><br><span class="line">        rep(i,<span class="number">0</span>,n) <span class="keyword">if</span>(sa[i]&gt;=k) y[p++]=sa[i]-k;</span><br><span class="line">        rep(i,<span class="number">0</span>,m) c[i]=<span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">0</span>,n) c[x[y[i]]]++;</span><br><span class="line">        rep(i,<span class="number">1</span>,m) c[i]+=c[i<span class="number">-1</span>];</span><br><span class="line">        dep(i,n<span class="number">-1</span>,<span class="number">0</span>) sa[--c[x[y[i]]]]=y[i];</span><br><span class="line">        swap(x,y);</span><br><span class="line">        p=<span class="number">1</span>; x[sa[<span class="number">0</span>]]=<span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,n) x[sa[i]]=y[sa[i<span class="number">-1</span>]]==y[sa[i]]&amp;&amp;y[sa[i<span class="number">-1</span>]+k]==y[sa[i]+k]?p<span class="number">-1</span>:p++;</span><br><span class="line">        <span class="keyword">if</span>(p&gt;=n) <span class="keyword">break</span>; m=p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getheight</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> k=<span class="number">0</span>;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) rk[sa[i]]=i;</span><br><span class="line">    rep(i,<span class="number">0</span>,n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(k) k--;</span><br><span class="line">        <span class="keyword">int</span> j=sa[rk[i]<span class="number">-1</span>];</span><br><span class="line">        <span class="keyword">while</span>(s[i+k]==s[j+k]) k++;</span><br><span class="line">        height[rk[i]]=k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">RMQ</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lg=(<span class="keyword">int</span>)(<span class="built_in">log</span>(n*<span class="number">1.0</span>)/<span class="built_in">log</span>(<span class="number">2.0</span>));</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) best[<span class="number">0</span>][i]=height[i];</span><br><span class="line">    rep(i,<span class="number">1</span>,lg+<span class="number">1</span>) <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j+(<span class="number">1</span>&lt;&lt;i)<span class="number">-1</span>&lt;=n;j++)</span><br><span class="line">        best[i][j]=min(best[i<span class="number">-1</span>][j],best[i<span class="number">-1</span>][j+(<span class="number">1</span>&lt;&lt;i&gt;&gt;<span class="number">1</span>)]); </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lcp</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    x=rk[x]; y=rk[y];</span><br><span class="line">    <span class="keyword">if</span>(x&gt;y) swap(x,y); x++;</span><br><span class="line">    <span class="keyword">int</span> lg=(<span class="keyword">int</span>)(<span class="built_in">log</span>(<span class="number">1.0</span>*(y-x+<span class="number">1</span>))/<span class="built_in">log</span>(<span class="number">2.0</span>));</span><br><span class="line">    <span class="keyword">return</span> min(best[lg][x],best[lg][y-(<span class="number">1</span>&lt;&lt;lg)+<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="后缀自动机"><a href="#后缀自动机" class="headerlink" title="后缀自动机"></a>后缀自动机</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SAM</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> next[maxn&lt;&lt;<span class="number">1</span>][<span class="number">26</span>],link[maxn&lt;&lt;<span class="number">1</span>],len[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span> a[maxn&lt;&lt;<span class="number">1</span>],id[maxn&lt;&lt;<span class="number">1</span>],right[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">int</span> tot,root,last;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        rep(i,<span class="number">0</span>,tot+<span class="number">1</span>) mst(next[i],<span class="number">0</span>),right[i]=<span class="number">0</span>;</span><br><span class="line">        mst(len,<span class="number">0</span>); mst(link,<span class="number">0</span>); tot=last=root=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">extend</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p=last,now=++tot; right[now]=<span class="number">1</span>; len[now]=len[p]+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(p&amp;&amp;!next[p][x]) next[p][x]=now,p=link[p];</span><br><span class="line">        <span class="keyword">if</span>(!p) link[now]=root;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">int</span> q=next[p][x];</span><br><span class="line">            <span class="keyword">if</span>(len[q]==len[p]+<span class="number">1</span>) link[now]=q;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">int</span> tmp=++tot;</span><br><span class="line">                <span class="built_in">memcpy</span>(next[tmp],next[q],<span class="keyword">sizeof</span>(next[q]));</span><br><span class="line">                link[tmp]=link[q]; link[q]=link[now]=tmp; len[tmp]=len[p]+<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span>(p&amp;&amp;next[p][x]==q) next[p][x]=tmp,p=link[p];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; last=now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 拓扑排序</span></span><br><span class="line">        rep(i,<span class="number">1</span>,tot+<span class="number">1</span>) ++a[len[i]];</span><br><span class="line">        rep(i,<span class="number">1</span>,tot+<span class="number">1</span>) a[i]+=a[i<span class="number">-1</span>];</span><br><span class="line">        rep(i,<span class="number">1</span>,tot+<span class="number">1</span>) id[a[len[i]]--]=i;</span><br><span class="line">        <span class="comment">// wz可能会记不得的sam简单运用：</span></span><br><span class="line">        <span class="comment">// ·s是否包含t：跑一遍t的点看next是不是都有值</span></span><br><span class="line">        <span class="comment">// ·s不同子串个数：累加len[id[i]]-len[link[id[i]]]</span></span><br><span class="line">        <span class="comment">// ·s不同子串总长度：累加(len[id[i]]+1)*len[id[i]]/2-(len[link[id[i]]]+1)*len[link[id[i]]]/2</span></span><br><span class="line">        <span class="comment">// ·s所有子串出现次数：</span></span><br><span class="line">        <span class="keyword">int</span> las=<span class="number">1</span>; rep(i,<span class="number">0</span>,n)&#123;</span><br><span class="line">            num[next[las][s[i]-<span class="string">&#x27;a&#x27;</span>]]=<span class="number">1</span>;</span><br><span class="line">            las=next[las][s[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        &#125; <span class="function">ll <span class="title">ans</span><span class="params">(<span class="number">0</span>)</span></span>; dep(i,tot,<span class="number">1</span>)&#123;</span><br><span class="line">            num[link[id[i]]]+=num[id[i]];</span><br><span class="line">            ans+=<span class="number">1ll</span>*(len[id[i]]-len[link[id[i]]])*num[id[i]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ·字典序第k大子串：</span></span><br><span class="line">        <span class="comment">//* op为0指计算本质不同子串 为1计算全部</span></span><br><span class="line">        <span class="keyword">if</span>(!op) rep(i,<span class="number">1</span>,tot+<span class="number">1</span>) right[i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> dep(i,tot,<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> t=id[i]; right[fa[t]]+=right[t];</span><br><span class="line">        &#125; right[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">        dep(i,tot,<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> t=id[i]; num[t]+=right[t];</span><br><span class="line">            rep(j,<span class="number">0</span>,<span class="number">26</span>) <span class="keyword">if</span>(next[t][j]) num[t]+=num[next[t][j]];</span><br><span class="line">        &#125; <span class="keyword">if</span>(k&gt;num[<span class="number">1</span>]) <span class="keyword">return</span> (<span class="keyword">void</span>)pf(<span class="string">&quot;No such line.\n&quot;</span>);</span><br><span class="line">        <span class="keyword">int</span> now=<span class="number">1</span>,cnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(k&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            rep(i,<span class="number">0</span>,<span class="number">26</span>) <span class="keyword">if</span>(next[now][i])&#123;</span><br><span class="line">                <span class="keyword">if</span>(k&lt;=num[next[now][i]])&#123;</span><br><span class="line">                    ans[cnt++]=<span class="string">&#x27;a&#x27;</span>+i; now=next[now][i];</span><br><span class="line">                    k-=right[now]; <span class="keyword">break</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> k-=num[next[now][i]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; ans[cnt]=<span class="number">0</span>; pf(<span class="string">&quot;%s\n&quot;</span>,ans);</span><br><span class="line">        <span class="comment">// ·t在s出现次数</span></span><br><span class="line">        <span class="comment">// ·t在s出现位置</span></span><br><span class="line">        <span class="comment">// ·多个字符串间的最长公共子串</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">lcs</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> las=<span class="number">1</span>,mx(<span class="number">0</span>),cnt(<span class="number">0</span>); rep(i,<span class="number">0</span>,m)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!next[las][t[i]-<span class="string">&#x27;a&#x27;</span>])&#123;</span><br><span class="line">                <span class="keyword">while</span>(las&amp;&amp;!next[las][t[i]-<span class="string">&#x27;a&#x27;</span>]) las=link[las];</span><br><span class="line">                <span class="keyword">if</span>(las) cnt=len[las]+<span class="number">1</span>,las=next[las][t[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">                <span class="keyword">else</span> las=<span class="number">1</span>,cnt=<span class="number">0</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> ++cnt,las=next[las][t[i]-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            mx=max(mx,cnt);</span><br><span class="line">        &#125; pf(<span class="string">&quot;%d\n&quot;</span>,mx);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;sam;</span><br></pre></td></tr></table></figure>
<h3 id="最大最小表示法"><a href="#最大最小表示法" class="headerlink" title="最大最小表示法"></a>最大最小表示法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getmin</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">1</span>,k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;len&amp;&amp;j&lt;len&amp;&amp;k&lt;len)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=s[(i+k)%len]-s[(j+k)%len];</span><br><span class="line">        <span class="keyword">if</span>(!tmp) k++; <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(tmp&gt;<span class="number">0</span>) i+=k+<span class="number">1</span>; <span class="keyword">else</span> j+=k+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i==j) j++; k=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">return</span> min(i,j);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getmax</span><span class="params">(<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s);</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">1</span>,k=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;len&amp;&amp;j&lt;len&amp;&amp;k&lt;len)&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=s[(i+k)%len]-s[(j+k)%len];</span><br><span class="line">        <span class="keyword">if</span>(!tmp) k++; <span class="keyword">else</span>&#123; </span><br><span class="line">            <span class="keyword">if</span>(tmp&lt;<span class="number">0</span>) i+=k+<span class="number">1</span>; <span class="keyword">else</span> j+=k+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i==j) j++; k=<span class="number">0</span>; </span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">return</span> min(i,j);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="回文树"><a href="#回文树" class="headerlink" title="回文树"></a>回文树</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 回文树初始节点01 表示偶/奇数长度串的根节点</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PAM</span>&#123;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">        <span class="keyword">int</span> child[<span class="number">26</span>],cnt,fail,num,len,pos;</span><br><span class="line">        <span class="comment">// len是从开头开始最长回文串长度</span></span><br><span class="line">        <span class="comment">// num是以这个结点结束的回文串数</span></span><br><span class="line">        <span class="comment">// cnt是节点表示的本质不同回文串数</span></span><br><span class="line">    &#125;tt[maxn];</span><br><span class="line">    <span class="keyword">int</span> last,n,tot;</span><br><span class="line">    <span class="keyword">char</span> s[maxn];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>&#123;</span><br><span class="line">        rep(i,<span class="number">0</span>,tot+<span class="number">1</span>)&#123;</span><br><span class="line">            mst(tt[i].child,<span class="number">0</span>);</span><br><span class="line">            tt[i].cnt=tt[i].fail=tt[i].len=tt[i].num=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last=n=<span class="number">0</span>; tt[<span class="number">0</span>].fail=tot=<span class="number">1</span>; tt[<span class="number">1</span>].len=<span class="number">-1</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getfail</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(s[n-tt[x].len<span class="number">-1</span>]!=s[n]) x=tt[x].fail;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">char</span> ch)</span></span>&#123;</span><br><span class="line">        s[++n]=ch;</span><br><span class="line">        <span class="keyword">int</span> cur=getfail(last);</span><br><span class="line">        <span class="keyword">if</span>(!tt[cur].child[ch-<span class="string">&#x27;a&#x27;</span>])&#123;</span><br><span class="line">            <span class="keyword">int</span> now=++tot;</span><br><span class="line">            tt[now].len=tt[cur].len+<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> p=getfail(tt[cur].fail);</span><br><span class="line">            tt[now].fail=tt[p].child[ch-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">            tt[cur].child[ch-<span class="string">&#x27;a&#x27;</span>]=now;</span><br><span class="line">            tt[now].num=tt[tt[now].fail].num+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        last=tt[n].pos=tt[cur].child[ch-<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line">        ++tt[last].cnt;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">count</span><span class="params">()</span></span>&#123;</span><br><span class="line">        dep(i,tot,<span class="number">0</span>) tt[tt[i].fail].cnt+=tt[i].cnt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;pam;</span><br></pre></td></tr></table></figure>
<h3 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> seed[<span class="number">2</span>]=&#123;<span class="number">27174403</span>,<span class="number">19260817</span>&#125;;</span><br><span class="line"><span class="comment">// 18052103</span></span><br><span class="line"><span class="comment">// 18271131 小燕学号 不是质数</span></span><br><span class="line"><span class="keyword">int</span> mod; <span class="comment">// 998244353 100000007 </span></span><br><span class="line"><span class="comment">// 大质数 9999999999999937/17</span></span><br><span class="line"><span class="keyword">int</span> hs[<span class="number">2</span>][maxn],bas[<span class="number">2</span>][maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    bas[<span class="number">0</span>][<span class="number">0</span>]=bas[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">1</span>; </span><br><span class="line">    rep(j,<span class="number">0</span>,<span class="number">2</span>) rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">        bas[j][i]=<span class="number">1ll</span>*bas[j][i<span class="number">-1</span>]*seed[j]%mod;</span><br><span class="line">        hs[j][i]=<span class="number">1ll</span>*hs[j][i<span class="number">-1</span>]*seed[j]%mod+s[i];</span><br><span class="line">        <span class="keyword">if</span>(hs[j][i]&gt;=mod) hs[j][i]-=mod;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getsum</span><span class="params">(<span class="keyword">int</span> j,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res=hs[j][r]<span class="number">-1ll</span>*hs[j][l<span class="number">-1</span>]*bas[j][r-l+<span class="number">1</span>]%mod;</span><br><span class="line">    <span class="keyword">if</span>(res&lt;<span class="number">0</span>) res+=mod; <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="自闭图论"><a href="#自闭图论" class="headerlink" title="自闭图论"></a>自闭图论</h2><h3 id="dijkstra"><a href="#dijkstra" class="headerlink" title="dijkstra"></a>dijkstra</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> id,dt;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> node a) <span class="keyword">const</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> dt&gt;a.dt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">priority_queue</span>&lt;node&gt;q;</span><br><span class="line"><span class="keyword">int</span> n,m,s,t,tot;</span><br><span class="line"><span class="keyword">int</span> dis[maxn],vis[maxn],head[maxn];</span><br><span class="line"><span class="keyword">int</span> nex[maxn&lt;&lt;<span class="number">1</span>],to[maxn&lt;&lt;<span class="number">1</span>],val[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    nex[++tot]=head[u];</span><br><span class="line">    head[u]=tot; to[tot]=v; val[tot]=w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dij</span><span class="params">(<span class="keyword">int</span> s)</span></span>&#123;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) dis[i]=<span class="number">1e9</span>; dis[s]=<span class="number">0</span>;</span><br><span class="line">    q.push(&#123;s,<span class="number">0</span>&#125;); <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        <span class="keyword">int</span> fr=q.top().id; q.pop();</span><br><span class="line">        <span class="keyword">if</span>(vis[fr]) <span class="keyword">continue</span>; vis[fr]++;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=head[fr];j;j=nex[j])</span><br><span class="line">            <span class="keyword">if</span>(dis[to[j]]&gt;val[j]+dis[fr]&amp;&amp;!vis[to[j]])&#123;</span><br><span class="line">                dis[to[j]]=val[j]+dis[fr];</span><br><span class="line">                q.push(&#123;to[j],dis[to[j]]&#125;);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="同余最短路"><a href="#同余最短路" class="headerlink" title="同余最短路"></a>同余最短路</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// n个数有Σai*xi=b b∈[b0,b1]</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rep(i,<span class="number">0</span>,a[<span class="number">0</span>]<span class="number">-1</span>) rep(j,<span class="number">0</span>,n)</span><br><span class="line">        addedge(i,(i+a[j])%a[<span class="number">0</span>],a[j]);</span><br><span class="line">    dij(<span class="number">0</span>); rep(i,<span class="number">0</span>,a[<span class="number">0</span>]<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> t=dis[i];</span><br><span class="line">        <span class="keyword">if</span>(t&lt;b0) ans+=(b1-t)/a[<span class="number">0</span>]-(b0-t<span class="number">-1</span>)/a[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(t&lt;=b1) ans+=(b1-t)/a[<span class="number">0</span>]+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="稳定婚姻问题"><a href="#稳定婚姻问题" class="headerlink" title="稳定婚姻问题"></a>稳定婚姻问题</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> b[maxn][maxn],g[maxn][maxn];</span><br><span class="line"><span class="comment">// b 每个男生按好感位次排下来的女生</span></span><br><span class="line"><span class="comment">// g 每个女生对应每个男生的好感度</span></span><br><span class="line"><span class="keyword">int</span> bm[maxn],gm[maxn];</span><br><span class="line"><span class="comment">// 对应异性号数</span></span><br><span class="line"><span class="keyword">int</span> vis[maxn][maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stable_marriage</span><span class="params">()</span></span>&#123;</span><br><span class="line">    mst(bm,<span class="number">-1</span>); mst(gm,<span class="number">-1</span>); mst(vis,<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) q.push(i);</span><br><span class="line">    <span class="keyword">int</span> fr,nex;</span><br><span class="line">    <span class="keyword">while</span>(!q.empty())&#123;</span><br><span class="line">        fr=q.front(); q.pop();</span><br><span class="line">        rep(i,<span class="number">1</span>,m+<span class="number">1</span>)&#123;</span><br><span class="line">            nex=b[fr][i];</span><br><span class="line">            <span class="keyword">if</span>(vis[fr][nex]) <span class="keyword">continue</span>; vis[fr][nex]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(gm[nex]==<span class="number">-1</span>)&#123;</span><br><span class="line">                gm[nex]=fr; bm[fr]=nex;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(g[nex][gm[nex]]&gt;g[nex][fr])&#123;</span><br><span class="line">                q.push(gm[nex]);</span><br><span class="line">                gm[nex]=fr; bm[fr]=nex;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二分匹配匈牙利算法"><a href="#二分匹配匈牙利算法" class="headerlink" title="二分匹配匈牙利算法"></a>二分匹配匈牙利算法</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="keyword">int</span> mp[maxn][maxn];</span><br><span class="line"><span class="keyword">int</span> vis[maxn],line[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ans=<span class="number">0</span>; mst(mp,<span class="number">0</span>); mst(line,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) <span class="keyword">if</span>(!vis[i]&amp;&amp;mp[i][x])&#123;</span><br><span class="line">        vis[i]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(!line[i]||dfs(line[i])) &#123;</span><br><span class="line">            line[i]=x; <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>)&#123; mst(vis,<span class="number">0</span>); <span class="keyword">if</span>(dfs(i)) ans++; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="强连通tarjan"><a href="#强连通tarjan" class="headerlink" title="强连通tarjan"></a>强连通tarjan</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,m,cnt,id;</span><br><span class="line"><span class="keyword">int</span> dfn[maxn],low[maxn];</span><br><span class="line"><span class="keyword">int</span> ins[maxn],scc[maxn];</span><br><span class="line"><span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt;s;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;vv[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cnt=id=<span class="number">0</span>; rep(i,<span class="number">0</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">        vv[i].clear();</span><br><span class="line">        dfn[i]=low[i]=ins[i]=scc[i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    dfn[x]=low[x]=++id; ins[x]=<span class="number">1</span>; s.push(x);</span><br><span class="line">    rep(i,<span class="number">0</span>,vv[x].size())&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=vv[x][i];</span><br><span class="line">        <span class="keyword">if</span>(!dfn[tmp])&#123; tarjan(tmp); low[x]=min(low[x],low[tmp]); &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ins[tmp]) low[x]=min(low[x],dfn[tmp]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(low[x]==dfn[x])&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp; cnt++; <span class="keyword">do</span>&#123;</span><br><span class="line">            tmp=s.top(); s.pop();</span><br><span class="line">            ins[tmp]=<span class="number">0</span>; scc[tmp]=cnt;</span><br><span class="line">        &#125; <span class="keyword">while</span>(x!=tmp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) <span class="keyword">if</span>(!dfn[i]) tarjan(i);</span><br><span class="line">    mst(ins,<span class="number">0</span>); mst(out,<span class="number">0</span>); </span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) rep(j,<span class="number">0</span>,vv[i].size())</span><br><span class="line">        <span class="keyword">if</span>(scc[i]!=scc[vv[i][j]])&#123;</span><br><span class="line">            ins[scc[vv[i][j]]]++; out[scc[i]]++;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="双连通分量"><a href="#双连通分量" class="headerlink" title="双连通分量"></a>双连通分量</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 割点：这个点一旦被删除，这张图的连通块数量会增加</span></span><br><span class="line"><span class="comment">// 桥：这条边一旦被删除，这张图的连通块数量会增加</span></span><br><span class="line"><span class="comment">// 带*边双</span></span><br><span class="line"><span class="keyword">int</span> n,m,cnt,id,child;</span><br><span class="line"><span class="keyword">int</span> dfn[maxn],low[maxn],isc[maxn];</span><br><span class="line"><span class="keyword">int</span> num[maxn],ans,sum;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;vv[maxn];</span><br><span class="line"><span class="comment">//* vector&lt;pii&gt;bri;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    cnt=id=child=<span class="number">0</span>; rep(i,<span class="number">0</span>,n+<span class="number">1</span>)&#123;</span><br><span class="line">        vv[i].clear();</span><br><span class="line">        dfn[i]=low[i]=isc[i]=<span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> f)</span></span>&#123;</span><br><span class="line">    dfn[x]=low[x]=++id; <span class="function"><span class="keyword">int</span> <span class="title">ff</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">    rep(i,<span class="number">0</span>,vv[x].size())&#123;</span><br><span class="line">        <span class="keyword">int</span> tmp=vv[x][i];</span><br><span class="line">        <span class="keyword">if</span>(tmp==f&amp;&amp;!ff)&#123; ff++; <span class="keyword">continue</span>; &#125; <span class="comment">// 重边 </span></span><br><span class="line">        <span class="keyword">if</span>(!dfn[tmp])&#123;</span><br><span class="line">            child++; tarjan(tmp,x);</span><br><span class="line">            low[x]=min(low[x],low[tmp]);</span><br><span class="line">            <span class="keyword">if</span>(low[tmp]&gt;dfn[x])&#123;</span><br><span class="line">                isc[x]=<span class="number">1</span>; <span class="comment">// 判断这个点是否为割点</span></span><br><span class="line">                <span class="comment">//* bri.push_back(pii(x,tmp));</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(dfn[tmp]&lt;dfn[x]) low[x]=min(low[x],dfn[tmp]);</span><br><span class="line">    &#125; <span class="keyword">if</span>(f==<span class="number">-1</span>&amp;&amp;child==<span class="number">1</span>) isc[x]=<span class="number">0</span>; <span class="comment">// 关于根节点的特判</span></span><br><span class="line">    <span class="comment">// 带缩点</span></span><br><span class="line">    <span class="keyword">if</span>(dfn[x]==low[x])&#123;</span><br><span class="line">        scc++; <span class="keyword">do</span>...<span class="keyword">while</span>...;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) <span class="keyword">if</span>(!dfn[i]) tarjan(i,<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="LCA"><a href="#LCA" class="headerlink" title="LCA"></a>LCA</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,m,tot,best[<span class="number">20</span>][maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> dis[maxn],vis[maxn],head[maxn];</span><br><span class="line"><span class="keyword">int</span> nex[maxn&lt;&lt;<span class="number">1</span>],to[maxn&lt;&lt;<span class="number">1</span>],val[maxn&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> id[maxn&lt;&lt;<span class="number">1</span>],num[maxn],dep[maxn&lt;&lt;<span class="number">1</span>],cnt;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addedge</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span></span>&#123;</span><br><span class="line">    nex[++tot]=head[u];</span><br><span class="line">    head[u]=tot; to[tot]=v; val[tot]=w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> f,<span class="keyword">int</span> d)</span></span>&#123;</span><br><span class="line">    id[++cnt]=x; num[x]=cnt; dep[cnt]=d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=nex[i])&#123;</span><br><span class="line">        <span class="keyword">int</span> y=to[i],z=val[i]; <span class="keyword">if</span>(y==f) <span class="keyword">continue</span>;</span><br><span class="line">        dis[y]=dis[x]+z; dfs(y,x,d+<span class="number">1</span>); id[++cnt]=x; dep[cnt]=d;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ST</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> lg=(<span class="keyword">int</span>)(<span class="built_in">log</span>(n*<span class="number">1.0</span>)/<span class="built_in">log</span>(<span class="number">2.0</span>));</span><br><span class="line">    rep(i,<span class="number">1</span>,n+<span class="number">1</span>) best[<span class="number">0</span>][i]=i;</span><br><span class="line">    rep(i,<span class="number">1</span>,lg+<span class="number">1</span>) <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j+(<span class="number">1</span>&lt;&lt;i)<span class="number">-1</span>&lt;=n;j++)&#123;</span><br><span class="line">        <span class="keyword">int</span> t1=best[i<span class="number">-1</span>][j],t2=best[i<span class="number">-1</span>][j+(<span class="number">1</span>&lt;&lt;i&gt;&gt;<span class="number">1</span>)];</span><br><span class="line">        best[i][j]=dep[t1]&lt;dep[t2]?t1:t2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">RMQ</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;y) swap(x,y);</span><br><span class="line">    <span class="keyword">int</span> lg=(<span class="keyword">int</span>)(<span class="built_in">log</span>(<span class="number">1.0</span>*(y-x+<span class="number">1</span>))/<span class="built_in">log</span>(<span class="number">2.0</span>));</span><br><span class="line">    <span class="keyword">int</span> t1=best[lg][x],t2=best[lg][y-(<span class="number">1</span>&lt;&lt;lg)+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> dep[t1]&lt;dep[t2]?t1:t2;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t1=num[x],t2=num[y];</span><br><span class="line">    <span class="keyword">return</span> id[RMQ(t1,t2)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getdis</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dis[x]+dis[y]<span class="number">-2</span>*dis[LCA(x,y)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dfs(<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>); ST(<span class="number">2</span>*n<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><h3 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123; </span><br><span class="line">    <span class="keyword">return</span> vis[x]==x?x:vis[x]=find(vis[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> c=find(x),d=find(y);</span><br><span class="line">    <span class="keyword">if</span>(c!=d) vis[c]=d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> tree[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123; <span class="keyword">return</span> i&amp;(-i); &#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> i,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(;i&lt;=maxn;i+=lowbit(i)) tree[i]+=x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;<span class="number">0</span>;i-=lowbit(i)) ans+=tree[i];</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 单点更新，加*区间更新</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> lson (rt&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> rson ((rt&lt;&lt;1)|1)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> mid ((begin+end)&gt;&gt;1)</span></span><br><span class="line"><span class="keyword">int</span> segtree[<span class="number">4</span>*maxn];</span><br><span class="line"><span class="comment">//* int lazy[4*maxn];</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> rt)</span></span>&#123;</span><br><span class="line">    segtree[rt]=segtree[lson]+segtree[rson];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/** void pushdown(int rt,int begin,int end)&#123;</span></span><br><span class="line"><span class="comment">    if (!lazy[rt]) return;</span></span><br><span class="line"><span class="comment">    segtree[lson]+=(mid-begin+1)*lazy[rt];</span></span><br><span class="line"><span class="comment">    segtree[rson]+=(end-mid)*lazy[rt];</span></span><br><span class="line"><span class="comment">    lazy[lson]+=lazy[rt];</span></span><br><span class="line"><span class="comment">    lazy[rson]+=lazy[rt];</span></span><br><span class="line"><span class="comment">    lazy[rt]=0;</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> begin,<span class="keyword">int</span> end)</span></span>&#123;</span><br><span class="line">    <span class="comment">//* lazy[rt]=0;</span></span><br><span class="line">    <span class="keyword">if</span>(begin==end)&#123; sc(segtree[rt]); <span class="keyword">return</span>; &#125;</span><br><span class="line">    build(lson,begin,mid);</span><br><span class="line">    build(rson,mid+<span class="number">1</span>,end);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> begin,<span class="keyword">int</span> end,<span class="keyword">int</span> pos,<span class="keyword">int</span> a)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(pos&lt;begin||pos&gt;end) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(begin==end)&#123; segtree[rt]+=a; <span class="keyword">return</span>; &#125;</span><br><span class="line">    update(lson,begin,mid,pos,a);</span><br><span class="line">    update(rson,mid+<span class="number">1</span>,end,pos,a);</span><br><span class="line">    pushup(rt);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/** void update(int rt,int begin,int end,int left,int right,int a)&#123;</span></span><br><span class="line"><span class="comment">    if(left&gt;end||right&lt;begin) return;</span></span><br><span class="line"><span class="comment">    if(left&lt;=begin&amp;&amp;right&gt;=end)&#123;</span></span><br><span class="line"><span class="comment">        segtree[rt]+=(end-begin+1)*a;</span></span><br><span class="line"><span class="comment">        lazy[rt]+=a; return;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    pushdown(rt,begin,end);</span></span><br><span class="line"><span class="comment">    update(lson,begin,mid,left,right,a);</span></span><br><span class="line"><span class="comment">    update(rson,mid+1,end,left,right,a);</span></span><br><span class="line"><span class="comment">    pushup(rt);</span></span><br><span class="line"><span class="comment">&#125;*/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">slove</span><span class="params">(<span class="keyword">int</span> rt,<span class="keyword">int</span> begin,<span class="keyword">int</span> end,<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(left&gt;end||right&lt;begin) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(left&lt;=begin&amp;&amp;right&gt;=end) <span class="keyword">return</span> segtree[rt];</span><br><span class="line">    <span class="comment">//* pushdown(rt,begin,end);</span></span><br><span class="line">    <span class="keyword">int</span> ans=<span class="number">0</span>;</span><br><span class="line">    ans+=slove(lson,begin,mid,left,right);</span><br><span class="line">    ans+=slove(rson,mid+<span class="number">1</span>,end,left,right);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="DP"><a href="#DP" class="headerlink" title="DP"></a>DP</h2><h3 id="数位dp"><a href="#数位dp" class="headerlink" title="数位dp"></a>数位dp</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[<span class="number">20</span>]; <span class="comment">// 位数 一般题目最大1e18</span></span><br><span class="line">ll dp[<span class="number">20</span>][state];</span><br><span class="line"><span class="function">ll <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> pre,<span class="comment">/*int state,*/</span><span class="keyword">int</span> limit)</span></span>&#123;</span><br><span class="line">    <span class="comment">// pos位数 pre之前状态 与dp数组对应 </span></span><br><span class="line">    <span class="comment">// state各种情况包括前导零 具体看题目 limit前一位限制 </span></span><br><span class="line">    <span class="keyword">if</span>(pos==<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// 计数，具体看题目</span></span><br><span class="line">    <span class="keyword">if</span>(!limit&amp;&amp;dp[pos][pre]!=<span class="number">-1</span><span class="comment">/*&amp;&amp;!state*/</span>) <span class="keyword">return</span> dp[pos][pre];</span><br><span class="line">    <span class="keyword">int</span> last=limit?a[pos]:<span class="number">9</span>;</span><br><span class="line">    ll ans=<span class="number">0</span>; rep(i,<span class="number">0</span>,last+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(...) ans+=dfs(pos<span class="number">-1</span>,...,<span class="comment">/*...,*/</span>limit&amp;&amp;i==a[pos]);</span><br><span class="line">        <span class="keyword">else</span>(...)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!limit<span class="comment">/*&amp;&amp;!state*/</span>) dp[pos][pre]=ans;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">slove</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    mst(dp,<span class="number">-1</span>); </span><br><span class="line">    <span class="comment">// 多组数据只用最开始mst一次 因为保证边界就可以了</span></span><br><span class="line">    <span class="keyword">int</span> pos=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(x)&#123; a[pos++]=x%<span class="number">10</span>; x/=<span class="number">10</span>; &#125;</span><br><span class="line">    <span class="keyword">return</span> dfs(pos<span class="number">-1</span>,<span class="number">0</span>,<span class="comment">/*...,*/</span><span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数学"><a href="#数学" class="headerlink" title="数学"></a>数学</h2><h3 id="常见公式"><a href="#常见公式" class="headerlink" title="常见公式"></a>常见公式</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1-n的平方和 n*(n+1)*(2*n+1)/6</span></span><br><span class="line"><span class="comment">// 1-n的立方和 n*n*(n+1)*(n+1)/4</span></span><br></pre></td></tr></table></figure>
<h3 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>; <span class="keyword">for</span>(;b&gt;<span class="number">0</span>;b&gt;&gt;=<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans=ans*a%mod;</span><br><span class="line">        a=a*a%mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 十进制ksm 大数幂次</span></span><br><span class="line"><span class="function">ll <span class="title">qpow</span><span class="params">(ll a,<span class="keyword">char</span>* s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s); ll res=<span class="number">1</span>,q=<span class="number">1</span>; dep(i,len<span class="number">-1</span>,<span class="number">0</span>)&#123;</span><br><span class="line">        rep(j,<span class="number">1</span>,s[i]-<span class="string">&#x27;0&#x27;</span>+<span class="number">1</span>) res=res*a%mod;</span><br><span class="line">        a=a*a%mod; q=a*a%mod; q=q*q%mod; a=q*a%mod;</span><br><span class="line">    &#125; <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="快速乘"><a href="#快速乘" class="headerlink" title="快速乘"></a>快速乘</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">qmul</span><span class="params">(ll a,ll b,ll p)</span></span>&#123;</span><br><span class="line">    a%=p; <span class="function">ll <span class="title">ans</span><span class="params">(<span class="number">0</span>)</span></span>; <span class="keyword">while</span>(b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans+=a; <span class="keyword">if</span>(ans&gt;=p) ans-=p;</span><br><span class="line">        b&gt;&gt;=<span class="number">1</span>; a+=a; <span class="keyword">if</span>(a&gt;=p) a-=p;</span><br><span class="line">    &#125; <span class="keyword">return</span> ans;</span><br><span class="line">&#125; <span class="comment">// olog</span></span><br><span class="line"><span class="function">ll <span class="title">modMul</span><span class="params">(ll a,ll b,ll p)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p&lt;=<span class="number">1000000000</span>) <span class="keyword">return</span> a*b%p;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(p&lt;=<span class="number">1000000000000ll</span>) <span class="keyword">return</span> (((a*(b&gt;&gt;<span class="number">20</span>)%p)&lt;&lt;<span class="number">20</span>)+(a*(b&amp;((<span class="number">1</span>&lt;&lt;<span class="number">20</span>)<span class="number">-1</span>))))%p;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        ll d=(ll)<span class="built_in">floor</span>(a*(<span class="keyword">long</span> <span class="keyword">double</span>)b/p+<span class="number">0.5</span>);</span><br><span class="line">        ll ret=(a*b-d*p)%p; <span class="keyword">if</span> (ret&lt;<span class="number">0</span>) ret+=p;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="comment">// o1</span></span><br></pre></td></tr></table></figure>
<h3 id="模逆元"><a href="#模逆元" class="headerlink" title="模逆元"></a>模逆元</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// exgcd</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123; x=<span class="number">1</span>; y=<span class="number">0</span>; <span class="keyword">return</span>; &#125;</span><br><span class="line">    exgcd(b,a%b,y,x); y-=(a/b)*x; <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">inv</span><span class="params">(ll a,ll p)</span></span>&#123;</span><br><span class="line">    ll x,y; exgcd(a,p,x,y);</span><br><span class="line">    <span class="keyword">return</span> (x%p+p)%p;</span><br><span class="line">&#125; <span class="comment">// 好像比ksm快的</span></span><br><span class="line"><span class="comment">// qpow</span></span><br><span class="line">inv=qpow(a,mod<span class="number">-2</span>,mod);</span><br><span class="line"><span class="comment">// 递推</span></span><br><span class="line">inv[i]=(mod-mod/i)*inv[mod%i]%mod;</span><br></pre></td></tr></table></figure>
<h3 id="组合数"><a href="#组合数" class="headerlink" title="组合数"></a>组合数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 预处理写法</span></span><br><span class="line"><span class="keyword">int</span> jc[maxn],inv[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    jc[<span class="number">0</span>]=inv[<span class="number">0</span>]=<span class="number">1</span>; rep(i,<span class="number">1</span>,maxn) jc[i]=<span class="number">1ll</span>*jc[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">    inv[maxn<span class="number">-1</span>]=qpow(jc[maxn<span class="number">-1</span>],mod<span class="number">-2</span>,mod);</span><br><span class="line">    dep(i,maxn<span class="number">-2</span>,<span class="number">1</span>) inv[i]=<span class="number">1ll</span>*inv[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C</span><span class="params">(<span class="keyword">int</span> s,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">1ll</span>*jc[x]*inv[s]%mod*inv[x-s]%mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// lucas</span></span><br><span class="line"><span class="function">ll <span class="title">Lucas</span><span class="params">(ll n,ll m,ll p)</span></span>&#123;</span><br><span class="line">    ll ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(n|m) ans=ans*C(n%p,m%p)%p,n/=p,m/=p;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="素数判断"><a href="#素数判断" class="headerlink" title="素数判断"></a>素数判断</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">isPrime</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">2</span>||n==<span class="number">3</span>||n==<span class="number">5</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(n%<span class="number">2</span>==<span class="number">0</span>||n%<span class="number">3</span>==<span class="number">0</span>||n%<span class="number">5</span>==<span class="number">0</span>||n==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll c=<span class="number">7</span>,a[<span class="number">8</span>]=&#123;<span class="number">4</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">6</span>&#125;;</span><br><span class="line">    <span class="keyword">while</span>(c*c&lt;=n) <span class="keyword">for</span>(<span class="keyword">auto</span> i:a)&#123; <span class="keyword">if</span>(n%c==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>; c+=i; &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125; <span class="comment">// 抠</span></span><br><span class="line"><span class="comment">// n极大时素数测试算法</span></span><br><span class="line"><span class="function">ll <span class="title">Rand</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">static</span> ll x=(srand((<span class="keyword">int</span>)time(<span class="number">0</span>)),rand());</span><br><span class="line">    x+=<span class="number">1000003</span>; <span class="keyword">if</span>(x&gt;mod) x-=mod; <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Witness</span><span class="params">(ll a,ll n)</span></span>&#123;</span><br><span class="line">    ll t=<span class="number">0</span>,u=n<span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(!(u&amp;<span class="number">1</span>)) u&gt;&gt;=<span class="number">1</span>,t++;</span><br><span class="line">    ll x=fpow(a,u,n),y;</span><br><span class="line">    <span class="keyword">while</span>(t--)&#123;</span><br><span class="line">        y=x*x%n;</span><br><span class="line">        <span class="keyword">if</span>(y==<span class="number">1</span>&amp;&amp;x!=<span class="number">1</span>&amp;&amp;x!=n<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        x=y;</span><br><span class="line">    &#125; <span class="keyword">return</span> x!=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">MillerRabin</span><span class="params">(ll n,ll s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n==<span class="number">2</span>||n==<span class="number">3</span>||n==<span class="number">5</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(n%<span class="number">2</span>==<span class="number">0</span>||n%<span class="number">3</span>==<span class="number">0</span>||n%<span class="number">5</span>==<span class="number">0</span>||n==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(s--) <span class="keyword">if</span>(Witness(Rand()%(n<span class="number">-1</span>)+<span class="number">1</span>,n)) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="求最小素因数"><a href="#求最小素因数" class="headerlink" title="求最小素因数"></a>求最小素因数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> p[maxn/<span class="number">3</span>],mpf[maxn],pn;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> tmp; rep(i,<span class="number">2</span>,maxn)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!mpf[i]) p[pn++]=i,mpf[i]=i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;(tmp=i*p[j])&lt;maxn;j++)&#123;</span><br><span class="line">            mpf[tmp]=p[j]; <span class="keyword">if</span>(!(i%p[j])) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Pollard’s-rho"><a href="#Pollard’s-rho" class="headerlink" title="Pollard’s rho"></a>Pollard’s rho</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 对于比较大的数分解因数</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">pair</span>&lt;ll,<span class="keyword">int</span>&gt; pli;</span><br><span class="line"><span class="keyword">namespace</span> pollard_rho&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> C=<span class="number">2307</span>;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> S=<span class="number">10</span>;</span><br><span class="line">    <span class="function">mt19937 <span class="title">rd</span><span class="params">(time(<span class="number">0</span>))</span></span>;</span><br><span class="line">    <span class="built_in">vector</span>&lt;ll&gt;ve;</span><br><span class="line">    <span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span>&#123; <span class="keyword">while</span>((a%=b)&amp;&amp;(b%=a)); <span class="keyword">return</span> a+b; &#125;</span><br><span class="line">    <span class="function">ll <span class="title">mul</span><span class="params">(ll a,ll b,ll mod)</span></span>&#123; <span class="keyword">return</span> (__int128)a*b%mod; &#125;</span><br><span class="line">    <span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b,ll mod)</span></span>&#123;</span><br><span class="line">        ll res=<span class="number">1</span>; a%=mod;</span><br><span class="line">        <span class="keyword">while</span>(b&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(b&amp;<span class="number">1</span>) res=mul(res,a,mod);</span><br><span class="line">            b&gt;&gt;=<span class="number">1</span>; a=mul(a,a,mod);</span><br><span class="line">        &#125; <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(ll a,ll n)</span></span>&#123;</span><br><span class="line">        ll m=n<span class="number">-1</span>,x,y; <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(!(m&amp;<span class="number">1</span>))m&gt;&gt;=<span class="number">1</span>,j++;</span><br><span class="line">        x=qpow(a,m,n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=j;x=y,i++)&#123;</span><br><span class="line">            y=mul(x,x,n);</span><br><span class="line">            <span class="keyword">if</span>(y==<span class="number">1</span>&amp;&amp;x!=<span class="number">1</span>&amp;&amp;x!=n<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">return</span> y!=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">miller_rabin</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">        ll a;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(!(n&amp;<span class="number">1</span>)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;S;i++) <span class="keyword">if</span>(check(rd()%(n<span class="number">-1</span>)+<span class="number">1</span>,n)) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ll <span class="title">pollard_rho</span><span class="params">(ll n,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">        ll i=<span class="number">1</span>,k=<span class="number">2</span>,x=rd()%n,y=x,d;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">            i++; x=(mul(x,x,n)+c)%n,d=gcd(y-x,n);</span><br><span class="line">            <span class="keyword">if</span>(d&gt;<span class="number">1</span>&amp;&amp;d&lt;n) <span class="keyword">return</span> d;</span><br><span class="line">            <span class="keyword">if</span>(y==x) <span class="keyword">return</span> n;</span><br><span class="line">            <span class="keyword">if</span>(i==k) y=x,k&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">findfac</span><span class="params">(ll n,<span class="keyword">int</span> c)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(miller_rabin(n))&#123;</span><br><span class="line">            ve.push_back(n);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125; ll m=n;</span><br><span class="line">        <span class="keyword">while</span>(m==n) m=pollard_rho(n,c--);</span><br><span class="line">        findfac(m,c);</span><br><span class="line">        findfac(n/m,c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;pli&gt; <span class="title">solve</span><span class="params">(ll n)</span></span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;pli&gt;res;</span><br><span class="line">        ve.clear();</span><br><span class="line">        findfac(n,C);</span><br><span class="line">        sort(ve.begin(),ve.end());</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x:ve)&#123;</span><br><span class="line">            <span class="keyword">if</span>(res.empty()||res.back().first!=x) res.push_back(&#123;x,<span class="number">1</span>&#125;);</span><br><span class="line">            <span class="keyword">else</span> res.back().second++;</span><br><span class="line">        &#125; <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="中国剩余定理"><a href="#中国剩余定理" class="headerlink" title="中国剩余定理"></a>中国剩余定理</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ll a[maxn],r[maxn];</span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123; x=<span class="number">1</span>; y=<span class="number">0</span>; <span class="keyword">return</span> a; &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        ll ans=exgcd(b,a%b,y,x);</span><br><span class="line">        y-=(a/b)*x; <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">excrt</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll m1,r1,m2,r2;</span><br><span class="line">    ll x,y,t,c,d;</span><br><span class="line">    m1=a[<span class="number">0</span>],r1=r[<span class="number">0</span>];</span><br><span class="line">    rep(i,<span class="number">1</span>,tot)&#123;</span><br><span class="line">        m2=a[i],r2=r[i];</span><br><span class="line">        c=r2-r1; d=exgcd(m1,m2,x,y);</span><br><span class="line">        <span class="keyword">if</span>(c%d) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">        t=m2/d; x*=c/d; x=(x%t+t)%t;</span><br><span class="line">        r1=x*m1+r1; m1=m1*m2/d;</span><br><span class="line">        r1=(r1%m1+m1)%m1;</span><br><span class="line">    &#125; <span class="keyword">return</span> pf(<span class="string">&quot;%d\n&quot;</span>,r1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 大数版</span></span><br><span class="line"><span class="keyword">import</span> java.math.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> BigInteger[] exgcd(BigInteger a,BigInteger b)&#123;</span><br><span class="line">        BigInteger ans;</span><br><span class="line">        BigInteger[] result=<span class="keyword">new</span> BigInteger[<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">if</span>(b.compareTo(BigInteger.ZERO)==<span class="number">0</span>)&#123;</span><br><span class="line">            result[<span class="number">0</span>]=a; result[<span class="number">1</span>]=BigInteger.ONE; result[<span class="number">2</span>]=BigInteger.ZERO;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        BigInteger[] tmp=exgcd(b,a.mod(b));</span><br><span class="line">        ans=tmp[<span class="number">0</span>]; result[<span class="number">0</span>]=ans; result[<span class="number">1</span>]=tmp[<span class="number">2</span>];</span><br><span class="line">        result[<span class="number">2</span>]=tmp[<span class="number">1</span>].subtract((a.divide(b).multiply(tmp[<span class="number">2</span>])));</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner sc=<span class="keyword">new</span> Scanner(System.in);</span><br><span class="line">        BigInteger a[]=<span class="keyword">new</span> BigInteger[<span class="number">105</span>];</span><br><span class="line">        BigInteger r[]=<span class="keyword">new</span> BigInteger[<span class="number">105</span>];</span><br><span class="line">        <span class="keyword">int</span> n; n=sc.nextInt();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            a[i]=sc.nextBigInteger();</span><br><span class="line">            r[i]=sc.nextBigInteger();</span><br><span class="line">        &#125;</span><br><span class="line">        BigInteger m1,m2,r1,r2,t,c;</span><br><span class="line">        BigInteger[] d;</span><br><span class="line">        m1=a[<span class="number">0</span>]; r1=r[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            m2=a[i]; r2=r[i]; c=r2.subtract(r1); d=exgcd(m1,m2);</span><br><span class="line">            <span class="keyword">if</span>(c.mod(d[<span class="number">0</span>]).compareTo(BigInteger.ZERO)!=<span class="number">0</span>)&#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            t=m2.divide(d[<span class="number">0</span>]); d[<span class="number">1</span>]=d[<span class="number">1</span>].multiply(c.divide(d[<span class="number">0</span>])).mod(t);</span><br><span class="line">            r1=d[<span class="number">1</span>].multiply(m1).add(r1); m1=m1.multiply(t);</span><br><span class="line">            r1=r1.mod(m1);</span><br><span class="line">        &#125;</span><br><span class="line">        d=exgcd(BigInteger.ONE,m1);</span><br><span class="line">        <span class="keyword">if</span>(r1.mod(d[<span class="number">0</span>]).compareTo(BigInteger.ZERO)!=<span class="number">0</span>)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        t=m1.divide(d[<span class="number">0</span>]); d[<span class="number">1</span>]=d[<span class="number">1</span>].multiply(r1.divide(d[<span class="number">0</span>])).mod(t);</span><br><span class="line">        System.out.println(d[<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ex-bsgs"><a href="#ex-bsgs" class="headerlink" title="(ex)bsgs"></a>(ex)bsgs</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 求解a^x=b(mod p)</span></span><br><span class="line"><span class="function">ll <span class="title">bsgs</span><span class="params">(ll a,ll b,ll p)</span></span>&#123;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;ll,ll&gt;tab; tab.clear();</span><br><span class="line">    ll u=(ll)<span class="built_in">ceil</span>(<span class="built_in">sqrt</span>(p)),ans;</span><br><span class="line">    rep(i,<span class="number">0</span>,u+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!i) ans=b%p,tab[ans]=i;</span><br><span class="line">        <span class="keyword">else</span> ans=ans*a%p,tab[ans]=i;</span><br><span class="line">    &#125; ll sum=qpow(a,u,p); ans=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(!sum) <span class="keyword">return</span> b?<span class="number">-1</span>:<span class="number">1</span>;</span><br><span class="line">    rep(i,<span class="number">1</span>,u+<span class="number">1</span>)&#123;</span><br><span class="line">        ans=ans*sum%p;</span><br><span class="line">        <span class="keyword">if</span>(tab[ans]) <span class="keyword">return</span> u*i-tab[ans];</span><br><span class="line">    &#125; <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="打表素数及莫比乌斯函数"><a href="#打表素数及莫比乌斯函数" class="headerlink" title="打表素数及莫比乌斯函数"></a>打表素数及莫比乌斯函数</h3> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> p[maxn],u[maxn],vis[maxn],pn;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    u[<span class="number">1</span>]=<span class="number">1</span>; rep(i,<span class="number">2</span>,maxn)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) p[pn++]=i,u[i]=<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;pn&amp;&amp;i*p[j]&lt;maxn;j++)&#123;</span><br><span class="line">            vis[i*p[j]]=<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i%p[j]) u[i*p[j]]=-u[i];</span><br><span class="line">            <span class="keyword">else</span> &#123; u[i*p[j]]=<span class="number">0</span>; <span class="keyword">break</span>; &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="反素数"><a href="#反素数" class="headerlink" title="反素数"></a>反素数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,p[]=&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>&#125;;</span><br><span class="line">ll ans=<span class="number">1e18</span>; <span class="comment">// n个因数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> pos,ll v,<span class="keyword">int</span> num)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(num&gt;n||pos&gt;<span class="number">15</span>) <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(num==n) <span class="keyword">return</span> ans=min(ans,v),(<span class="keyword">void</span>)<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">64</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(v&gt;ans/p[pos]||num*(i+<span class="number">1</span>)&gt;n) <span class="keyword">break</span>; v*=p[pos];</span><br><span class="line">        <span class="keyword">if</span>(!(n%(num*(i+<span class="number">1</span>)))) dfs(pos+<span class="number">1</span>,v,num*(i+<span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span></span>&#123; dfs(<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>); &#125;</span><br><span class="line"><span class="comment">// ans是因数有n个的最小正整数</span></span><br></pre></td></tr></table></figure>
<h3 id="欧拉函数"><a href="#欧拉函数" class="headerlink" title="欧拉函数"></a>欧拉函数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">getphi</span><span class="params">(ll x)</span></span>&#123;</span><br><span class="line">    ll res=x; rep(i,<span class="number">2</span>,x+<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1ll</span>*i*i&gt;x) <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">if</span>(x%i==<span class="number">0</span>)&#123;</span><br><span class="line">            res=res/i*(i<span class="number">-1</span>);</span><br><span class="line">            <span class="keyword">while</span>(x%i==<span class="number">0</span>) x/=i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">if</span>(x&gt;<span class="number">1</span>) res=res/x*(x<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="欧拉降幂"><a href="#欧拉降幂" class="headerlink" title="欧拉降幂"></a>欧拉降幂</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 求qpow(a,b,p)有</span></span><br><span class="line"><span class="keyword">if</span>(__gcd(a,p)==<span class="number">1</span>) ans=qpow(a,b%phi(p),p);</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(__gcd(a,p)&gt;<span class="number">1</span>&amp;&amp;b&lt;phi(p)) ans==qpow(a,b,p);</span><br><span class="line"><span class="keyword">else</span> ans=qpow(a,b%phi(p)+phi(p),p);</span><br></pre></td></tr></table></figure>
<h3 id="BM"><a href="#BM" class="headerlink" title="BM"></a>BM</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> linear_seq&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> N=<span class="number">101100</span>;</span><br><span class="line">    ll res[N],base[N],_c[N],_md[N];</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;Md;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(ll *a,ll *b,<span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">        rep(i,<span class="number">0</span>,k+k) _c[i]=<span class="number">0</span>;</span><br><span class="line">        rep(i,<span class="number">0</span>,k) <span class="keyword">if</span> (a[i]) rep(j,<span class="number">0</span>,k) _c[i+j]=(_c[i+j]+a[i]*b[j])%mod;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=k+k<span class="number">-1</span>;i&gt;=k;i--) <span class="keyword">if</span>(_c[i])</span><br><span class="line">            rep(j,<span class="number">0</span>,Md.size()) _c[i-k+Md[j]]=(_c[i-k+Md[j]]-_c[i]*_md[Md[j]])%mod;</span><br><span class="line">        rep(i,<span class="number">0</span>,k) a[i]=_c[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">slove</span><span class="params">(ll n,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; b)</span></span>&#123;</span><br><span class="line">        <span class="comment">// a系数 b初值 b[n+1]=a[0]*b[n]+...</span></span><br><span class="line">        ll ans=<span class="number">0</span>,pnt=<span class="number">0</span>; <span class="keyword">int</span> k=a.size();</span><br><span class="line">        assert((<span class="keyword">int</span>)a.size()==(<span class="keyword">int</span>)b.size()); Md.clear();</span><br><span class="line">        rep(i,<span class="number">0</span>,k) _md[k<span class="number">-1</span>-i]=-a[i]; _md[k]=<span class="number">1</span>;</span><br><span class="line">        rep(i,<span class="number">0</span>,k) <span class="keyword">if</span> (_md[i]!=<span class="number">0</span>) Md.push_back(i);</span><br><span class="line">        rep(i,<span class="number">0</span>,k) res[i]=base[i]=<span class="number">0</span>; res[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>((<span class="number">1ll</span>&lt;&lt;pnt)&lt;=n) pnt++; dep(p,pnt,<span class="number">0</span>)&#123;</span><br><span class="line">            mul(res,res,k); <span class="keyword">if</span>((n&gt;&gt;p)&amp;<span class="number">1</span>)&#123;</span><br><span class="line">                dep(i,k<span class="number">-1</span>,<span class="number">0</span>) res[i+<span class="number">1</span>]=res[i];res[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">                rep(j,<span class="number">0</span>,Md.size()) res[Md[j]]=(res[Md[j]]-res[k]*_md[Md[j]])%mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; rep(i,<span class="number">0</span>,k) ans=(ans+res[i]*b[i])%mod;</span><br><span class="line">        <span class="keyword">if</span>(ans&lt;<span class="number">0</span>) ans+=mod; <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="title">BM</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; s)</span></span>&#123;</span><br><span class="line">        vector&lt;int&gt; C(1,1),B(1,1);</span><br><span class="line">        <span class="keyword">int</span> L=<span class="number">0</span>,m=<span class="number">1</span>,b=<span class="number">1</span>;</span><br><span class="line">        rep(n,<span class="number">0</span>,s.size())&#123;</span><br><span class="line">            ll d=<span class="number">0</span>; rep(i,<span class="number">0</span>,L+<span class="number">1</span>) d=(d+(ll)C[i]*s[n-i])%mod;</span><br><span class="line">            <span class="keyword">if</span>(d==<span class="number">0</span>) ++m; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="number">2</span>*L&lt;=n)&#123;</span><br><span class="line">                <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; T=C;</span><br><span class="line">                ll c=mod-d*qpow(b,mod<span class="number">-2</span>)%mod;</span><br><span class="line">                <span class="keyword">while</span>((<span class="keyword">int</span>)C.size()&lt;(<span class="keyword">int</span>)B.size()+m) C.push_back(<span class="number">0</span>);</span><br><span class="line">                rep(i,<span class="number">0</span>,B.size()) C[i+m]=(C[i+m]+c*B[i])%mod;</span><br><span class="line">                L=n+<span class="number">1</span>-L; B=T; b=d; m=<span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">                ll c=mod-d*qpow(b,mod<span class="number">-2</span>)%mod;</span><br><span class="line">                <span class="keyword">while</span>((<span class="keyword">int</span>)C.size()&lt;(<span class="keyword">int</span>)B.size()+m) C.push_back(<span class="number">0</span>);</span><br><span class="line">                rep(i,<span class="number">0</span>,B.size()) C[i+m]=(C[i+m]+c*B[i])%mod;</span><br><span class="line">                ++m;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">return</span> C;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">qaq</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; a,ll n)</span></span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; c=BM(a); c.erase(c.begin());</span><br><span class="line">        rep(i,<span class="number">0</span>,c.size()) c[i]=(mod-c[i])%mod;</span><br><span class="line">        <span class="keyword">return</span> slove(n,c,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(a.begin(),a.begin()+(<span class="keyword">int</span>)c.size()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">slove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;vv; <span class="function">ll <span class="title">tmp</span><span class="params">(<span class="number">0</span>)</span></span>; rep(i,<span class="number">1</span>,maxn)&#123;</span><br><span class="line">        tmp=...; vv.push_back(tmp);</span><br><span class="line">    &#125; ll ans=linear_seq::qaq(vv,n<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="二次剩余"><a href="#二次剩余" class="headerlink" title="二次剩余"></a>二次剩余</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">judge</span><span class="params">(ll a,ll p)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 判断a是否为p的二次剩余 p是素数</span></span><br><span class="line">    <span class="keyword">return</span> qpow(a,(p<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>,p)==<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">ll <span class="title">Shanks</span><span class="params">(ll a,ll p)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 求解二次同余方程x^2=a(mod p) p是素数</span></span><br><span class="line">    <span class="keyword">if</span>(a==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    ll q=p<span class="number">-1</span>,e=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!(q&amp;<span class="number">1</span>)) q&gt;&gt;=<span class="number">1</span>,e++;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> mt19937_64 <span class="title">rd</span><span class="params">(time(<span class="number">0</span>))</span></span>;</span><br><span class="line">    ll n=rd()%(p<span class="number">-1</span>)+<span class="number">1</span>;</span><br><span class="line">    <span class="comment">// 随机选取p的一个非二次剩余，若p为定值，n也可为定值</span></span><br><span class="line">    <span class="keyword">while</span>(judge(n,p)) n=rd()%(p<span class="number">-1</span>)+<span class="number">1</span>;</span><br><span class="line">    ll z=qpow(n,q,p),y=z,r=e,x=qpow(a,(q<span class="number">-1</span>)&gt;&gt;<span class="number">1</span>,p),b=a*x%p*x%p;</span><br><span class="line">    x=a*x%p; <span class="keyword">while</span>(b!=<span class="number">1</span>)&#123;</span><br><span class="line">        ll temp=b*b%p,m=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(temp!=<span class="number">1</span>) (temp*=temp)%=p,m++;</span><br><span class="line">        <span class="keyword">if</span>(m==r) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        ll t=y; rep(i,<span class="number">1</span>,r-m<span class="number">-1</span>)(t*=t)%=p;</span><br><span class="line">        y=t*t%p,r=m%p,x=x*t%p,b=b*y%p;</span><br><span class="line">    &#125; <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="fft"><a href="#fft" class="headerlink" title="fft"></a>fft</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">complex</span>&lt;<span class="keyword">double</span>&gt; cd;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(cd* f,<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j=n&gt;&gt;<span class="number">1</span>; rep(i,<span class="number">1</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i&lt;j) swap(f[i],f[j]);</span><br><span class="line">        <span class="keyword">int</span> k=n&gt;&gt;<span class="number">1</span>; <span class="keyword">while</span>(j&gt;=k)&#123;</span><br><span class="line">            j-=k; k&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">if</span>(j&lt;k) j+=k;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fft</span><span class="params">(cd* f,<span class="keyword">int</span> n,<span class="keyword">int</span> dft)</span></span>&#123; <span class="comment">// n为多项式位数</span></span><br><span class="line">    change(f,n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> step=<span class="number">1</span>;step&lt;n;step&lt;&lt;=<span class="number">1</span>)&#123; <span class="comment">// 合并</span></span><br><span class="line">        cd wn=<span class="built_in">exp</span>(cd(<span class="number">0</span>,dft*PI/step));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j+=step&lt;&lt;<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="function">cd <span class="title">wnk</span><span class="params">(<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> k=j;k&lt;j+step;k++)&#123;</span><br><span class="line">                cd x=f[k],y=wnk*f[k+step];</span><br><span class="line">                f[k]=x+y; <span class="comment">// F(x)=G(x)+ωH(x)</span></span><br><span class="line">                f[k+step]=x-y;</span><br><span class="line">                wnk*=wn;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">if</span>(dft==<span class="number">-1</span>) rep(i,<span class="number">0</span>,n) f[i]/=n;</span><br><span class="line">    <span class="comment">// IDFT需要整个矩阵的内容乘上1/n  </span></span><br><span class="line">&#125;</span><br><span class="line">cd a[maxn],b[maxn]; <span class="keyword">int</span> ans[maxn];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> mx=...,L=<span class="number">1</span>; <span class="keyword">while</span>(L&lt;mx*<span class="number">2</span>) L&lt;&lt;=<span class="number">1</span>;</span><br><span class="line">    mst(ans,<span class="number">0</span>); fft(a,L,<span class="number">1</span>); fft(b,L,<span class="number">1</span>);</span><br><span class="line">    rep(i,<span class="number">0</span>,L) a[i]=a[i]*b[i]; fft(a,L,<span class="number">-1</span>);</span><br><span class="line">    rep(i,<span class="number">0</span>,L) ans[i]=(<span class="keyword">int</span>)(a[i].real()+<span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="fwt"><a href="#fwt" class="headerlink" title="fwt"></a>fwt</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fwt_or</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;N;j+=i&lt;&lt;<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;i;++k)</span><br><span class="line">				<span class="keyword">if</span>(op==<span class="number">1</span>) a[i+j+k]=(a[j+k]+a[i+j+k])%mod;</span><br><span class="line">				<span class="keyword">else</span> a[i+j+k]=(a[i+j+K]-a[j+K]+mod)%mod;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fwt_and</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;N;j+=i&lt;&lt;<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;i;++k)</span><br><span class="line">				<span class="keyword">if</span>(op==<span class="number">1</span>) a[j+k]=(a[j+k]+a[i+j+k])%mod;</span><br><span class="line">				<span class="keyword">else</span> a[j+k]=(a[j+K]-a[i+j+K]+mod)%mod;</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">fwt_xor</span><span class="params">(<span class="keyword">int</span> *a,<span class="keyword">int</span> op)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;N;i&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;N;j+=i&lt;&lt;<span class="number">1</span>)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;i;++k)&#123;</span><br><span class="line">				<span class="keyword">int</span> x=a[j+k],y=a[i+j+k];</span><br><span class="line">				a[j+k]=(x+y)%mod,a[i+j+k]=(x-y+mod)%mod;</span><br><span class="line">				<span class="keyword">if</span>(op==<span class="number">-1</span>) a[j+k]=<span class="number">1ll</span>*a[j+k]*inv2%mod,</span><br><span class="line">					a[i+j+k]=<span class="number">1ll</span>*a[i+j+k]*inv2%mod;</span><br><span class="line">			&#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="拉格朗日插值"><a href="#拉格朗日插值" class="headerlink" title="拉格朗日插值"></a>拉格朗日插值</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> polysum&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> D = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line">    ll a[D],f[D],g[D],p1[D],p2[D],b[D],h[D][<span class="number">2</span>],C[D];</span><br><span class="line">	<span class="function">ll <span class="title">qpow</span><span class="params">(ll a,ll b)</span></span>&#123;</span><br><span class="line">		ll ans=<span class="number">1</span>; <span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(b&amp;<span class="number">1</span>) ans=ans*a%mod;</span><br><span class="line">			a=a*a%mod;</span><br><span class="line">		&#125; <span class="keyword">return</span> ans;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> M)</span></span>&#123;</span><br><span class="line">        f[<span class="number">0</span>]=f[<span class="number">1</span>]=g[<span class="number">0</span>]=g[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        rep(i,<span class="number">2</span>,M+<span class="number">5</span>) f[i]=f[i<span class="number">-1</span>]*i%mod;</span><br><span class="line">        g[M+<span class="number">4</span>]=qpow(f[M+<span class="number">4</span>],mod<span class="number">-2</span>);</span><br><span class="line">        dep(i,M+<span class="number">3</span>,<span class="number">2</span>) g[i]=g[i+<span class="number">1</span>]*(i+<span class="number">1</span>)%mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 已知f(0),f(1)..f(d) 求 f(n)</span></span><br><span class="line">    <span class="function">ll <span class="title">calcn</span><span class="params">(ll d,ll *a,ll n)</span></span>&#123; <span class="comment">// a[0].. a[d]  a[n] </span></span><br><span class="line">        <span class="keyword">if</span>(n&lt;=d) <span class="keyword">return</span> a[n];</span><br><span class="line">        p1[<span class="number">0</span>]=p2[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        rep(i,<span class="number">0</span>,d+<span class="number">1</span>)&#123;</span><br><span class="line">            ll t=(n-i+mod)%mod;</span><br><span class="line">            p1[i+<span class="number">1</span>]=p1[i]*t%mod;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i,<span class="number">0</span>,d+<span class="number">1</span>)&#123;</span><br><span class="line">            ll t=(n-d+i+mod)%mod;</span><br><span class="line">            p2[i+<span class="number">1</span>]=p2[i]*t%mod;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">ll <span class="title">ans</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">        rep(i,<span class="number">0</span>,d+<span class="number">1</span>)&#123;</span><br><span class="line">            ll t=g[i]*g[d-i]%mod*p1[i]%mod*p2[d-i]%mod*a[i]%mod;</span><br><span class="line">            <span class="keyword">if</span>((d-i)&amp;<span class="number">1</span>) ans=(ans-t+mod)%mod;</span><br><span class="line">            <span class="keyword">else</span> ans=(ans+t)%mod;</span><br><span class="line">        &#125; <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">// 已知 f(0),f(1)...f(m),求\sum_&#123;i=0 &#125;^&#123;n&#125; f[i]</span></span><br><span class="line">    <span class="function">ll <span class="title">polysum</span><span class="params">(ll m,ll *a,ll n)</span></span>&#123; <span class="comment">// a[0].. a[m] </span></span><br><span class="line">		ll b[D]; </span><br><span class="line">        rep(i,<span class="number">0</span>,m+<span class="number">1</span>) b[i]=a[i];</span><br><span class="line">        b[m+<span class="number">1</span>]=calcn(m,b,m+<span class="number">1</span>);</span><br><span class="line">        rep(i,<span class="number">1</span>,m+<span class="number">2</span>) b[i]=(b[i<span class="number">-1</span>]+b[i])%mod;</span><br><span class="line">        <span class="keyword">return</span> calcn(m+<span class="number">1</span>,b,n<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// a[0].. a[m] \sum_&#123;i=0&#125;^&#123;n-1&#125; a[i]*R^i</span></span><br><span class="line">    <span class="function">ll <span class="title">qpolysum</span><span class="params">(ll R,ll n,ll *a,ll m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(R==<span class="number">1</span>) <span class="keyword">return</span> polysum(n,a,m);</span><br><span class="line">        a[m+<span class="number">1</span>]=calcn(m,a,m+<span class="number">1</span>);</span><br><span class="line">        ll r=qpow(R,mod<span class="number">-2</span>),p3=<span class="number">0</span>,p4=<span class="number">0</span>,c,ans;</span><br><span class="line">        h[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>; h[<span class="number">0</span>][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        rep(i,<span class="number">1</span>,m+<span class="number">2</span>)&#123;</span><br><span class="line">            h[i][<span class="number">0</span>]=(h[i<span class="number">-1</span>][<span class="number">0</span>]+a[i<span class="number">-1</span>])*r%mod;</span><br><span class="line">            h[i][<span class="number">1</span>]=h[i<span class="number">-1</span>][<span class="number">1</span>]*r%mod;</span><br><span class="line">        &#125;</span><br><span class="line">        rep(i,<span class="number">0</span>,m+<span class="number">2</span>)&#123;</span><br><span class="line">            ll t=g[i]*g[m+<span class="number">1</span>-i]%mod;</span><br><span class="line">            <span class="keyword">if</span>(i&amp;<span class="number">1</span>) p3=((p3-h[i][<span class="number">0</span>]*t)%mod+mod)%mod,p4=((p4-h[i][<span class="number">1</span>]*t)%mod+mod)%mod;</span><br><span class="line">            <span class="keyword">else</span> p3=(p3+h[i][<span class="number">0</span>]*t)%mod,p4=(p4+h[i][<span class="number">1</span>]*t)%mod;</span><br><span class="line">        &#125;</span><br><span class="line">        c=qpow(p4,mod<span class="number">-2</span>)*(mod-p3)%mod;</span><br><span class="line">        rep(i,<span class="number">0</span>,m+<span class="number">2</span>) h[i][<span class="number">0</span>]=(h[i][<span class="number">0</span>]+h[i][<span class="number">1</span>]*c)%mod;</span><br><span class="line">        rep(i,<span class="number">0</span>,m+<span class="number">2</span>) C[i]=h[i][<span class="number">0</span>];</span><br><span class="line">        ans=(calcn(m,C,n)*qpow(R,n)%mod-c)%mod;</span><br><span class="line">        <span class="keyword">if</span>(ans&lt;<span class="number">0</span>) ans+=mod;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<h3 id="博弈"><a href="#博弈" class="headerlink" title="博弈"></a>博弈</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 巴什博弈：一堆物品n两人轮流取物，一次最多m</span></span><br><span class="line"><span class="comment">根据n%(m+1)是否为零判断胜者 */</span></span><br><span class="line"><span class="comment">/* 威佐夫博奕：两堆物品a、b两人轮流取物，一次只能在一堆任意取或是两堆取同样多 //默认a&lt;b</span></span><br><span class="line"><span class="comment">根据(int)((double)(1.0+sqrt(4.0))/2.0)*(b-a))是否等于a判断胜者</span></span><br><span class="line"><span class="comment">扩展威佐夫博弈：两堆物品a、b两人轮流取物，一次只能在一堆任意取或是两堆取相差不超过k的 //默认a&lt;b */</span></span><br><span class="line"><span class="keyword">if</span>(a&gt;b) swap(a,b);</span><br><span class="line"><span class="keyword">if</span>(a==<span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(b==k+<span class="number">2</span>?<span class="string">&quot;0&quot;</span>:<span class="string">&quot;1&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(a==k+<span class="number">2</span>||b==k+<span class="number">2</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">ll r=(b-a)%(k+<span class="number">1</span>); <span class="keyword">if</span>(r) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>);</span><br><span class="line"><span class="keyword">double</span> t=(<span class="number">1.0</span>-k+<span class="built_in">sqrt</span>(<span class="number">1ll</span>*(k+<span class="number">1</span>)*(k+<span class="number">1</span>)+<span class="number">4.0</span>))/<span class="number">2.0</span>;</span><br><span class="line">ll q=(b-a)/(k+<span class="number">1</span>); q=(ll)q*t;</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">puts</span>(q==a?<span class="string">&quot;0&quot;</span>:<span class="string">&quot;1&quot;</span>);</span><br><span class="line"><span class="comment">/* Fibonacci博弈：一堆物品n，两人轮流取物，每一次能取的个数是上一次的两倍以内，最后取完胜</span></span><br><span class="line"><span class="comment">n为Fibonacci数时先手败 */</span></span><br><span class="line"><span class="comment">// k倍动态减法</span></span><br><span class="line"><span class="comment">// 一堆石头 第一步可以拿1~n-1个石头 之后每步最多拿上一步的k倍</span></span><br><span class="line"><span class="keyword">int</span> a[maxn],b[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">slove</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n,k; sc(n); sc(k); a[<span class="number">0</span>]=b[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>; <span class="keyword">while</span>(n&gt;a[i])&#123;</span><br><span class="line">        i++; a[i]=b[i<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(a[j+<span class="number">1</span>]*k&lt;a[i]) j++;</span><br><span class="line">        <span class="keyword">if</span>(a[j]*k&lt;a[i]) b[i]=b[j]+a[i];</span><br><span class="line">        <span class="keyword">else</span> b[i]=a[i];</span><br><span class="line">    &#125; <span class="keyword">if</span>(a[i]==n) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;lose&quot;</span>); <span class="comment">// 先手败</span></span><br><span class="line">    <span class="keyword">int</span> ans; <span class="keyword">while</span>(n)&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&gt;=a[i]) n-=a[i],ans=a[i]; i--;</span><br><span class="line">    &#125; <span class="keyword">return</span> pf(<span class="string">&quot;%d\n&quot;</span>,ans); <span class="comment">// 第一步所拿最少数</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="斐波那契求循环节"><a href="#斐波那契求循环节" class="headerlink" title="斐波那契求循环节"></a>斐波那契求循环节</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">给定一个数n 求%n的斐波那契循坏节长度len</span></span><br><span class="line"><span class="comment">·n为质数且5是模n的二次剩余 len为(n-1)的因子</span></span><br><span class="line"><span class="comment">·n为质数且5不为模n的二次剩余 len为(2n+2)的因子</span></span><br><span class="line"><span class="comment">·n为质数p的k次 len为lenp*p^(k-1)</span></span><br><span class="line"><span class="comment">·n分解为质因数 len为每个质因数循环节长度的lcm</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h2 id="计算几何"><a href="#计算几何" class="headerlink" title="计算几何"></a>计算几何</h2><h3 id="二维几何"><a href="#二维几何" class="headerlink" title="二维几何"></a>二维几何</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 一般形式</span></span><br><span class="line"><span class="comment">// 直线L上两点(x1,y1),(x2,y2);</span></span><br><span class="line"><span class="comment">// 直线外一点P(x0,y0);</span></span><br><span class="line"><span class="comment">// L表示为Ax+By+C=0;</span></span><br><span class="line"><span class="keyword">double</span> A,B,C;</span><br><span class="line">A=y2-y1; B=x1-x2; C=x2*y1-x1*y2;</span><br><span class="line"><span class="comment">// 点到直线距离d</span></span><br><span class="line"><span class="keyword">double</span> d=<span class="built_in">fabs</span>(A*x0+B*y0+C)/<span class="built_in">sqrt</span>(A*A+B*B);</span><br><span class="line"><span class="comment">// 点到直线垂足H(x, y)</span></span><br><span class="line"><span class="keyword">double</span> x,y;</span><br><span class="line">x=(B*B*x0-A*B*y0-A*C)/(A*A+B*B);</span><br><span class="line">y=(-A*B*x0+A*A*y0-B*C)/(A*A+B*B);</span><br><span class="line"><span class="comment">// 点关于直线的对称点P&#x27;(_x, _y);</span></span><br><span class="line"><span class="keyword">double</span> k,_x,_y;</span><br><span class="line">k=<span class="number">-2</span>*(A*x0+B*y0+C)/(A*A+B*B); _x=x0+k*A; _y=y0+k*B;</span><br><span class="line"><span class="comment">// 求三角形内整数点个数</span></span><br><span class="line"><span class="comment">// 三角形三个顶点坐标(x1, y1), (x2, y2), (x3, y3) 都为整数点</span></span><br><span class="line"><span class="keyword">int</span> t1,t2,t3; <span class="comment">// 三边上整数点个数</span></span><br><span class="line">t1=gcd(<span class="built_in">abs</span>(x1-x2),<span class="built_in">abs</span>(y1-y2));</span><br><span class="line">t2=gcd(<span class="built_in">abs</span>(x3-x2),<span class="built_in">abs</span>(y3-y2));</span><br><span class="line">t3=gcd(<span class="built_in">abs</span>(x1-x3),<span class="built_in">abs</span>(y1-y3));</span><br><span class="line"><span class="keyword">int</span> num; <span class="comment">// 三角形内整数点</span></span><br><span class="line">num=<span class="built_in">abs</span>((x2-x1)*(y3-y2)-(x3-x2)*(y2-y1))/<span class="number">2</span>;</span><br><span class="line">num-=(t1+t2+t3)/<span class="number">2</span><span class="number">-1</span>; </span><br><span class="line"><span class="comment">// 皮克定理</span></span><br><span class="line"><span class="comment">// 一个格点多边形有 S=a+b/2-1;</span></span><br><span class="line"><span class="comment">// S面积 a内部格点数 b边上格点数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 结构体形式</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">point</span>&#123;</span></span><br><span class="line">    <span class="keyword">double</span> x,y;</span><br><span class="line">    point(<span class="keyword">double</span> _x=<span class="number">0</span>,<span class="keyword">double</span> _y=<span class="number">0</span>)&#123; x=_x,y=_y; &#125;</span><br><span class="line">    point <span class="keyword">operator</span>+ (<span class="keyword">const</span> point&amp; a) <span class="keyword">const</span>&#123; <span class="keyword">return</span> point(x+a.x,y+a.y); &#125;</span><br><span class="line">    point <span class="keyword">operator</span>- (<span class="keyword">const</span> point&amp; a) <span class="keyword">const</span>&#123; <span class="keyword">return</span> point(x-a.x,y-a.y); &#125;</span><br><span class="line">    point <span class="keyword">operator</span>* (<span class="keyword">double</span> a) <span class="keyword">const</span>&#123; <span class="keyword">return</span> point(x*a,y*a); &#125;</span><br><span class="line">&#125;; <span class="comment">// 点</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">line</span>&#123;</span></span><br><span class="line">    point s,e;</span><br><span class="line">    line(point a,point b)&#123; s=a,e=b; &#125;</span><br><span class="line">    line()&#123;&#125;</span><br><span class="line">&#125;; <span class="comment">// 线</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">dcmp</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;eps) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">return</span> x&lt;-eps?<span class="number">-1</span>:<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">getdis</span><span class="params">(point a, point b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> xx=a.x-b.x,yy=a.y-b.y;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sqrt</span>(xx*xx+yy*yy);</span><br><span class="line">&#125; <span class="comment">// 两点距离</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">multi</span><span class="params">(point a,point b,point c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> xa,ya,xb,yb;</span><br><span class="line">    xa=b.x-a.x; ya=b.y-a.y;</span><br><span class="line">    xb=c.x-b.x; yb=c.y-b.y;</span><br><span class="line">    <span class="keyword">return</span> xa*xb+ya*yb;</span><br><span class="line">&#125; <span class="comment">// 点乘</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">cross</span><span class="params">(point a,point b,point c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> xa,ya,xb,yb;</span><br><span class="line">    xa=b.x-a.x; ya=b.y-a.y;</span><br><span class="line">    xb=c.x-a.x; yb=c.y-a.y;</span><br><span class="line">    <span class="keyword">return</span> xa*yb-xb*ya;</span><br><span class="line">&#125; <span class="comment">// 叉乘</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">judgec</span><span class="params">(line a,line b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (max(a.s.x,a.e.x)&gt;=min(b.s.x,b.e.x) &amp;&amp;</span><br><span class="line">        max(a.s.y,a.e.y)&gt;=min(b.s.y,b.e.y) &amp;&amp;</span><br><span class="line">        max(b.s.x,b.e.x)&gt;=min(a.s.x,a.e.x) &amp;&amp;</span><br><span class="line">        max(b.s.y,b.e.y)&gt;=min(a.s.y,a.e.y) &amp;&amp;</span><br><span class="line">        cross(a.s,b.s,b.e)*cross(a.e,b.s,b.e)&lt;=<span class="number">0</span> </span><br><span class="line">        &amp;&amp; cross(b.s,a.s,a.e)*cross(b.e,a.s,a.e)&lt;=<span class="number">0</span></span><br><span class="line">        ) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125; <span class="comment">// 判断线段是否相交</span></span><br><span class="line"><span class="function">point <span class="title">getpoi</span><span class="params">(point a,point b,point c,point d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> u=cross(a,b,c),v=cross(b,a,d);</span><br><span class="line">    <span class="keyword">return</span> point((c.x*v+d.x*u)/(u+v),(c.y*v+d.y*u)/(u+v));</span><br><span class="line">&#125; <span class="comment">// 求交点</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">parea</span><span class="params">(point p[],<span class="keyword">int</span> n)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n&lt;<span class="number">3</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">double</span> ans=<span class="number">0</span>; p[n]=p[<span class="number">0</span>];</span><br><span class="line">    rep(i,<span class="number">0</span>,n) ans+=p[i].x*p[i+<span class="number">1</span>].y-p[i+<span class="number">1</span>].x*p[i].y; </span><br><span class="line">    <span class="keyword">return</span> ans/<span class="number">2</span>;</span><br><span class="line">&#125; <span class="comment">// 多边形面积</span></span><br><span class="line"><span class="comment">// 求两个多边形面积交/并</span></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">CPIA</span><span class="params">(point a[],point b[],<span class="keyword">int</span> n1,<span class="keyword">int</span> n2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(n2&lt;<span class="number">3</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    point p[<span class="number">15</span>],t[<span class="number">15</span>];</span><br><span class="line">    a[n1]=a[<span class="number">0</span>]; b[n2]=b[<span class="number">0</span>];</span><br><span class="line">    <span class="built_in">memcpy</span>(p,b,<span class="keyword">sizeof</span>(point)*(n2+<span class="number">1</span>));</span><br><span class="line">    rep(i,<span class="number">0</span>,n1)&#123;</span><br><span class="line">        <span class="keyword">int</span> f1=dcmp(cross(a[i],a[i+<span class="number">1</span>],p[<span class="number">0</span>])),tn=<span class="number">0</span>;</span><br><span class="line">        rep(j,<span class="number">0</span>,n2)&#123;</span><br><span class="line">            <span class="keyword">if</span>(f1&gt;=<span class="number">0</span>) t[tn++]=p[j];</span><br><span class="line">            <span class="keyword">int</span> f2=dcmp(cross(a[i],a[i+<span class="number">1</span>],p[j+<span class="number">1</span>]));</span><br><span class="line">            <span class="keyword">if</span>((f1^f2)==<span class="number">-2</span>) t[tn++]=getpoi(a[i],a[i+<span class="number">1</span>],p[j],p[j+<span class="number">1</span>]);</span><br><span class="line">            f1=f2;</span><br><span class="line">        &#125; <span class="built_in">memcpy</span>(p,t,<span class="keyword">sizeof</span>(point)*tn);</span><br><span class="line">        n2=tn; p[n2]=p[<span class="number">0</span>];</span><br><span class="line">    &#125; <span class="keyword">return</span> parea(p,n2);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">SPIA</span><span class="params">(point a[],point b[],<span class="keyword">int</span> n1,<span class="keyword">int</span> n2)</span></span>&#123;</span><br><span class="line">    point t1[<span class="number">5</span>],t2[<span class="number">5</span>]; a[n1]=t1[<span class="number">0</span>]=a[<span class="number">0</span>]; b[n2]=t2[<span class="number">0</span>]=b[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">double</span> res=<span class="number">0</span>; rep(i,<span class="number">2</span>,n1)&#123;</span><br><span class="line">        t1[<span class="number">1</span>]=a[i<span class="number">-1</span>]; t1[<span class="number">2</span>]=a[i]; <span class="keyword">int</span> f1=dcmp(cross(t1[<span class="number">0</span>],t1[<span class="number">1</span>],t1[<span class="number">2</span>]));</span><br><span class="line">        <span class="keyword">if</span>(f1&lt;<span class="number">0</span>) swap(t1[<span class="number">1</span>],t1[<span class="number">2</span>]); rep(j,<span class="number">2</span>,n2)&#123;</span><br><span class="line">            t2[<span class="number">1</span>]=b[j<span class="number">-1</span>]; t2[<span class="number">2</span>]=b[j]; <span class="keyword">int</span> f2=dcmp(cross(t2[<span class="number">0</span>],t2[<span class="number">1</span>],t2[<span class="number">2</span>]));</span><br><span class="line">            <span class="keyword">if</span>(f2&lt;<span class="number">0</span>) swap(t2[<span class="number">1</span>],t2[<span class="number">2</span>]); res+=CPIA(t1,t2,<span class="number">3</span>,<span class="number">3</span>)*f1*f2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">return</span> <span class="built_in">fabs</span>(res); <span class="comment">//面积交 </span></span><br><span class="line">    <span class="comment">//return fabs(parea(a,n1)+parea(b,n2)-res); //面积并 </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">double</span> gx, gy;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">find_gra</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> area=<span class="number">0</span>,tmp;</span><br><span class="line">    rep(i,<span class="number">1</span>,n<span class="number">-1</span>)&#123;</span><br><span class="line">        tmp=(p[i].x-p[<span class="number">0</span>].x)*(p[i+<span class="number">1</span>].y-p[<span class="number">0</span>].y)-(p[i+<span class="number">1</span>].x-p[<span class="number">0</span>].x)*(p[i].y-p[<span class="number">0</span>].y); area+=tmp;</span><br><span class="line">        gx+=(p[<span class="number">0</span>].x+p[i].x+p[i+<span class="number">1</span>].x)*tmp;</span><br><span class="line">        gy+=(p[<span class="number">0</span>].y+p[i].y+p[i+<span class="number">1</span>].y)*tmp;</span><br><span class="line">    &#125; gx=gx/<span class="number">3</span>/area, gy=gy/<span class="number">3</span>/area;</span><br><span class="line">&#125; <span class="comment">// 求重心坐标</span></span><br></pre></td></tr></table></figure>
<h3 id="二维凸包"><a href="#二维凸包" class="headerlink" title="二维凸包"></a>二维凸包</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以下凸包Graham</span></span><br><span class="line"><span class="keyword">int</span> top;</span><br><span class="line">point p[maxn],s[maxn];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">iszero</span><span class="params">(<span class="keyword">double</span> x)</span></span>&#123; <span class="keyword">return</span> <span class="built_in">fabs</span>(x)&lt;eps; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">cmp</span><span class="params">(point a,point b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">double</span> tt=multi(a,b,p[<span class="number">0</span>]);</span><br><span class="line">    <span class="keyword">if</span>(tt&gt;<span class="number">0</span>||iszero(tt)&amp;&amp;getdis(a,p[<span class="number">0</span>])&lt;getdis(b,p[<span class="number">0</span>])) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">graham</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    point tmp;</span><br><span class="line">    rep(i,<span class="number">1</span>,n) <span class="keyword">if</span>(p[i].y&lt;p[<span class="number">0</span>].y||(p[i].y==p[<span class="number">0</span>].y&amp;&amp;p[i].x&lt;p[<span class="number">0</span>].x)) swap(p[<span class="number">0</span>],p[i]);</span><br><span class="line">    sort(p+<span class="number">1</span>,p+n,cmp);</span><br><span class="line">    s[<span class="number">0</span>]=p[<span class="number">0</span>]; s[<span class="number">1</span>]=p[<span class="number">1</span>]; s[<span class="number">2</span>]=p[<span class="number">2</span>]; top=<span class="number">2</span>;</span><br><span class="line">    rep(i,<span class="number">3</span>,n)&#123;</span><br><span class="line">        <span class="keyword">while</span>(top&gt;=<span class="number">2</span>&amp;&amp;multi(s[top<span class="number">-1</span>],s[top],p[i])&lt;=eps) top--;</span><br><span class="line">        s[++top]=p[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><h3 id="快读"><a href="#快读" class="headerlink" title="快读"></a>快读</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 这句是io流包装，记住就好</span></span><br><span class="line">        StreamTokenizer in = <span class="keyword">new</span> StreamTokenizer(<span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(System.in)));</span><br><span class="line">        PrintWriter out = <span class="keyword">new</span> PrintWriter(<span class="keyword">new</span> OutputStreamWriter(System.out));</span><br><span class="line">        <span class="comment">/*in.resetSyntax();</span></span><br><span class="line"><span class="comment">        in.whitespaceChars(0, 32);</span></span><br><span class="line"><span class="comment">        in.wordChars(&#x27;0&#x27;, &#x27;9&#x27;);</span></span><br><span class="line"><span class="comment">        in.wordChars(&#x27;-&#x27;, &#x27;.&#x27;);</span></span><br><span class="line"><span class="comment">        in.wordChars(&#x27;+&#x27;, &#x27;+&#x27;);</span></span><br><span class="line"><span class="comment">        in.wordChars(&#x27;a&#x27;, &#x27;z&#x27;);</span></span><br><span class="line"><span class="comment">        in.wordChars(&#x27;A&#x27;, &#x27;Z&#x27;);</span></span><br><span class="line"><span class="comment">        in.wordChars(0xa0, 0xff); </span></span><br><span class="line"><span class="comment">        in.slashSlashComments(true);</span></span><br><span class="line"><span class="comment">        in.slashStarComments(true);</span></span><br><span class="line"><span class="comment">        in.quoteChar(&#x27;&quot;&#x27;);</span></span><br><span class="line"><span class="comment">        in.quoteChar(&#x27;\&#x27;&#x27;);*/</span></span><br><span class="line">        <span class="comment">// 以上加上可以将数字当字符串读</span></span><br><span class="line">        <span class="comment">// StreamTokenizer.TT_EOF这个是个参数，就是EOF</span></span><br><span class="line">        <span class="keyword">while</span> (in.nextToken() != StreamTokenizer.TT_EOF) &#123;</span><br><span class="line">            String n = in.sval;</span><br><span class="line">            in.nextToken(); <span class="comment">// 没记错是换行</span></span><br><span class="line">            <span class="keyword">double</span> m = in.nval;</span><br><span class="line">            <span class="keyword">int</span> a = (<span class="keyword">int</span>) in.nval;</span><br><span class="line">            out.println(m);</span><br><span class="line">            out.flush(); <span class="comment">// 刷新，不然max会留在缓冲区</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="高精度"><a href="#高精度" class="headerlink" title="高精度"></a>高精度</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.math.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Scanner sc=<span class="keyword">new</span> Scanner(System.in); <span class="comment">// 普通读入</span></span><br><span class="line">        <span class="keyword">while</span>(sc.hasNext())&#123;</span><br><span class="line">            <span class="comment">// 大数常见函数</span></span><br><span class="line">            BigInteger.valueOf(); <span class="comment">// int转大数</span></span><br><span class="line">            BigInteger a = <span class="keyword">new</span> BigInteger(<span class="comment">/*val:*/</span><span class="string">&quot;&quot;</span>);</span><br><span class="line">            BigInteger b = <span class="keyword">new</span> BigInteger(<span class="comment">/*String*/</span>);</span><br><span class="line">            BigInteger array[]=<span class="keyword">new</span> BigInteger[maxn];</span><br><span class="line">            add(); subtract(); multiply(); divide();</span><br><span class="line">            compareTo(); mod(); pow(); gcd(); <span class="comment">// 理论上大部分有补全的</span></span><br><span class="line">            System.out.println(a.stripTrailingZeros().toPlainString()); <span class="comment">// 实数的输出去除末尾0</span></span><br><span class="line">            Arrays.sort(a,<span class="number">0</span>,n); <span class="comment">// 数组排序</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="各种函数"><a href="#各种函数" class="headerlink" title="各种函数"></a>各种函数</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">is_sorted(a+l,a+r); <span class="comment">// 判断数组a在区间是否有序</span></span><br><span class="line">__builtin_popcount(x); <span class="comment">// 计算二进制x有几个1</span></span><br><span class="line">__builtin_popcountll(x); <span class="comment">// ll模式 末尾加个ll</span></span><br><span class="line">prev_permutation(iterator strat,iterator end);</span><br><span class="line">next_permutation(iterator strat,iterator end);</span><br></pre></td></tr></table></figure>
<h3 id="pbds"><a href="#pbds" class="headerlink" title="pbds"></a>pbds</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 平衡树</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ext/pb_ds/tree_policy.hpp&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_pbds;</span><br><span class="line">tree&lt;/*int*/,null_type,greater&lt;/*int*/&gt;,rb_tree_tag,tree_order_statistics_node_update&gt; T;</span><br><span class="line"><span class="comment">// 第一个参数是数据类型</span></span><br><span class="line"><span class="comment">// 第二个要填null_type，低版本编译器填null_mapped_type</span></span><br><span class="line"><span class="comment">// 第三个填比较函数 std::greater&lt;&gt; or std::less&lt;&gt; or cmp</span></span><br><span class="line"><span class="comment">// 第四个填树的类型，有rb_tree_tag红黑树和splay_tree_tag</span></span><br><span class="line"><span class="comment">// 第五个是为了支持查询第k大和排名的一个参数</span></span><br><span class="line">T.insert(x); T.erase(x); T.lower_bound(x);</span><br><span class="line"><span class="keyword">int</span> rk=(<span class="keyword">int</span>)T.order_of_key(x)+<span class="number">1</span>; <span class="comment">// 查询一个数的排名</span></span><br><span class="line"><span class="keyword">int</span> num=(<span class="keyword">int</span>)*T.find_by_order(x<span class="number">-1</span>)); <span class="comment">//查询第k大的数 返回迭代器</span></span><br><span class="line"><span class="comment">// rope</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;ext/rope&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> __gnu_cxx;</span><br><span class="line">rope&lt;/*int*/&gt;r;</span><br><span class="line">r.push_back(x); <span class="comment">// 在末尾添加x</span></span><br><span class="line">r.insert(pos,x); <span class="comment">// 在pos插入x，自然支持整个char数组的一次插入</span></span><br><span class="line">r.erase(pos,x); <span class="comment">// 从pos开始删除x个</span></span><br><span class="line">r.copy(pos,len,x); <span class="comment">// 从pos开始到pos+len为止用x代替</span></span><br><span class="line">r.replace(pos,x); <span class="comment">// 从pos开始换成x</span></span><br><span class="line">r.substr(pos,x); <span class="comment">// 提取pos开始x个</span></span><br></pre></td></tr></table></figure>
<h3 id="指令集优化"><a href="#指令集优化" class="headerlink" title="指令集优化"></a>指令集优化</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(3)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC optimize(<span class="meta-string">&quot;Ofast,no-stack-protector&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> GCC target(<span class="meta-string">&quot;sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2,tune=native&quot;</span>)</span></span><br></pre></td></tr></table></figure>
<h3 id="关同步"><a href="#关同步" class="headerlink" title="关同步"></a>关同步</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ios::sync_with_stdio(<span class="number">0</span>); <span class="built_in">cin</span>.tie(<span class="number">0</span>); <span class="built_in">cout</span>.tie(<span class="number">0</span>);</span><br></pre></td></tr></table></figure>
<h3 id="快读-1"><a href="#快读-1" class="headerlink" title="快读"></a>快读</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,w=<span class="number">0</span>;<span class="keyword">char</span> ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(ch)) w|=ch==<span class="string">&#x27;-&#x27;</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(ch)) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+ch-<span class="string">&#x27;0&#x27;</span>,ch=getchar();</span><br><span class="line">    <span class="keyword">return</span> w?-x:x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="int128输入输出"><a href="#int128输入输出" class="headerlink" title="__int128输入输出"></a>__int128输入输出</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">scan</span><span class="params">(__int128 &amp;x)</span></span>&#123;</span><br><span class="line">    x=<span class="number">0</span>; <span class="keyword">int</span> op=<span class="number">1</span>; <span class="keyword">char</span> c=getchar();</span><br><span class="line">    <span class="keyword">while</span>(c&lt;<span class="string">&#x27;0&#x27;</span>||c&gt;<span class="string">&#x27;9&#x27;</span>) op=(c==<span class="string">&#x27;-&#x27;</span>?<span class="number">-1</span>:<span class="number">1</span>),c=getchar(); </span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">&#x27;0&#x27;</span>&amp;&amp;c&lt;=<span class="string">&#x27;9&#x27;</span>) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+c-<span class="string">&#x27;0&#x27;</span>,c=getchar();</span><br><span class="line">    x*=op;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(__int128 x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x&lt;<span class="number">0</span>)&#123; x=-x; <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>); &#125;</span><br><span class="line">    <span class="keyword">if</span>(x&gt;<span class="number">9</span>) print(x/<span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(x%<span class="number">10</span>+<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="随机"><a href="#随机" class="headerlink" title="随机"></a>随机</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mt19937 mrand(chrono::high_resolution_clock::now().time_since_epoch().count());</span><br><span class="line">int rnd(int x)&#123; return mrand()%x; &#125;</span><br></pre></td></tr></table></figure>
<h3 id="给逆元求概率"><a href="#给逆元求概率" class="headerlink" title="给逆元求概率"></a>给逆元求概率</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">slove</span><span class="params">(ll pa,ll xa,ll pb,ll xb,ll &amp;a,ll &amp;b)</span></span>&#123;</span><br><span class="line">    ll tmp=(pa<span class="number">-1</span>)/xa;</span><br><span class="line">    <span class="keyword">if</span>(tmp+<span class="number">1</span>&lt;=pb/xb)&#123; a=tmp+<span class="number">1</span>; b=<span class="number">1</span>; <span class="keyword">return</span>; &#125; </span><br><span class="line">    pa-=tmp*xa; pb-=tmp*xb; </span><br><span class="line">    slove(xb,pb,xa,pa,b,a); a+=tmp*b; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getsample</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ll p,x,a,b; scl(p); scl(x);</span><br><span class="line">    <span class="comment">// p模的质数 x结果 </span></span><br><span class="line">    slove(p,x,p,x<span class="number">-1</span>,a,b); </span><br><span class="line">    ll c=x*a-p*b; pf(<span class="string">&quot;%lld/%lld\n&quot;</span>,c,a);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="entry-meta entry-footer">
      
	<span class="ico-folder"></span>
    <a class="article-category-link" href="/categories/w/">w</a>

      
  <span class="ico-tags"></span>
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ACM/" rel="tag">ACM</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9D%BF%E5%AD%90/" rel="tag">板子</a></li></ul>

      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>



      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/01/11/%E5%B8%A6%E6%A8%A1%E6%8B%9F/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          一道快乐的井字棋带模拟
        
      </div>
    </a>
  
  
    <a href="/2019/12/31/2019%E6%B5%81%E6%B0%B4%E8%B4%A6%E6%80%BB%E7%BB%93/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2019流水账总结</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    
      <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="nav-number">1.</span> <span class="nav-text">头文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="nav-number">2.</span> <span class="nav-text">字符串操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#char%E5%87%BD%E6%95%B0"><span class="nav-number">2.1.</span> <span class="nav-text">char函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#string%E5%87%BD%E6%95%B0"><span class="nav-number">2.2.</span> <span class="nav-text">string函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E5%85%B8%E6%A0%91"><span class="nav-number">2.3.</span> <span class="nav-text">字典树</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#KMP"><span class="nav-number">2.4.</span> <span class="nav-text">KMP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EXKMP"><span class="nav-number">2.5.</span> <span class="nav-text">EXKMP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A9%AC%E6%8B%89%E8%BD%A6"><span class="nav-number">2.6.</span> <span class="nav-text">马拉车</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AC%E8%87%AA%E5%8A%A8%E6%9C%BA"><span class="nav-number">2.7.</span> <span class="nav-text">AC自动机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E7%BC%80%E6%95%B0%E7%BB%84"><span class="nav-number">2.8.</span> <span class="nav-text">后缀数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8E%E7%BC%80%E8%87%AA%E5%8A%A8%E6%9C%BA"><span class="nav-number">2.9.</span> <span class="nav-text">后缀自动机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E5%A4%A7%E6%9C%80%E5%B0%8F%E8%A1%A8%E7%A4%BA%E6%B3%95"><span class="nav-number">2.10.</span> <span class="nav-text">最大最小表示法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%9E%E6%96%87%E6%A0%91"><span class="nav-number">2.11.</span> <span class="nav-text">回文树</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hash"><span class="nav-number">2.12.</span> <span class="nav-text">hash</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%87%AA%E9%97%AD%E5%9B%BE%E8%AE%BA"><span class="nav-number">3.</span> <span class="nav-text">自闭图论</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#dijkstra"><span class="nav-number">3.1.</span> <span class="nav-text">dijkstra</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8C%E4%BD%99%E6%9C%80%E7%9F%AD%E8%B7%AF"><span class="nav-number">3.2.</span> <span class="nav-text">同余最短路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%B3%E5%AE%9A%E5%A9%9A%E5%A7%BB%E9%97%AE%E9%A2%98"><span class="nav-number">3.3.</span> <span class="nav-text">稳定婚姻问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E5%88%86%E5%8C%B9%E9%85%8D%E5%8C%88%E7%89%99%E5%88%A9%E7%AE%97%E6%B3%95"><span class="nav-number">3.4.</span> <span class="nav-text">二分匹配匈牙利算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%BA%E8%BF%9E%E9%80%9Atarjan"><span class="nav-number">3.5.</span> <span class="nav-text">强连通tarjan</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8C%E8%BF%9E%E9%80%9A%E5%88%86%E9%87%8F"><span class="nav-number">3.6.</span> <span class="nav-text">双连通分量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LCA"><span class="nav-number">3.7.</span> <span class="nav-text">LCA</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-number">4.</span> <span class="nav-text">数据结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%B6%E6%9F%A5%E9%9B%86"><span class="nav-number">4.1.</span> <span class="nav-text">并查集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84"><span class="nav-number">4.2.</span> <span class="nav-text">树状数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%BF%E6%AE%B5%E6%A0%91"><span class="nav-number">4.3.</span> <span class="nav-text">线段树</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DP"><span class="nav-number">5.</span> <span class="nav-text">DP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E4%BD%8Ddp"><span class="nav-number">5.1.</span> <span class="nav-text">数位dp</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E5%AD%A6"><span class="nav-number">6.</span> <span class="nav-text">数学</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E5%85%AC%E5%BC%8F"><span class="nav-number">6.1.</span> <span class="nav-text">常见公式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="nav-number">6.2.</span> <span class="nav-text">快速幂</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F%E4%B9%98"><span class="nav-number">6.3.</span> <span class="nav-text">快速乘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E9%80%86%E5%85%83"><span class="nav-number">6.4.</span> <span class="nav-text">模逆元</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E6%95%B0"><span class="nav-number">6.5.</span> <span class="nav-text">组合数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B4%A0%E6%95%B0%E5%88%A4%E6%96%AD"><span class="nav-number">6.6.</span> <span class="nav-text">素数判断</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E6%9C%80%E5%B0%8F%E7%B4%A0%E5%9B%A0%E6%95%B0"><span class="nav-number">6.7.</span> <span class="nav-text">求最小素因数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pollard%E2%80%99s-rho"><span class="nav-number">6.8.</span> <span class="nav-text">Pollard’s rho</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E5%9B%BD%E5%89%A9%E4%BD%99%E5%AE%9A%E7%90%86"><span class="nav-number">6.9.</span> <span class="nav-text">中国剩余定理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ex-bsgs"><span class="nav-number">6.10.</span> <span class="nav-text">(ex)bsgs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E8%A1%A8%E7%B4%A0%E6%95%B0%E5%8F%8A%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%87%BD%E6%95%B0"><span class="nav-number">6.11.</span> <span class="nav-text">打表素数及莫比乌斯函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8D%E7%B4%A0%E6%95%B0"><span class="nav-number">6.12.</span> <span class="nav-text">反素数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="nav-number">6.13.</span> <span class="nav-text">欧拉函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AC%A7%E6%8B%89%E9%99%8D%E5%B9%82"><span class="nav-number">6.14.</span> <span class="nav-text">欧拉降幂</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BM"><span class="nav-number">6.15.</span> <span class="nav-text">BM</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E5%89%A9%E4%BD%99"><span class="nav-number">6.16.</span> <span class="nav-text">二次剩余</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fft"><span class="nav-number">6.17.</span> <span class="nav-text">fft</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fwt"><span class="nav-number">6.18.</span> <span class="nav-text">fwt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC"><span class="nav-number">6.19.</span> <span class="nav-text">拉格朗日插值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%9A%E5%BC%88"><span class="nav-number">6.20.</span> <span class="nav-text">博弈</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%B1%82%E5%BE%AA%E7%8E%AF%E8%8A%82"><span class="nav-number">6.21.</span> <span class="nav-text">斐波那契求循环节</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95"><span class="nav-number">7.</span> <span class="nav-text">计算几何</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E5%87%A0%E4%BD%95"><span class="nav-number">7.1.</span> <span class="nav-text">二维几何</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E5%87%B8%E5%8C%85"><span class="nav-number">7.2.</span> <span class="nav-text">二维凸包</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Java"><span class="nav-number">8.</span> <span class="nav-text">Java</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E8%AF%BB"><span class="nav-number">8.1.</span> <span class="nav-text">快读</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AB%98%E7%B2%BE%E5%BA%A6"><span class="nav-number">8.2.</span> <span class="nav-text">高精度</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">9.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%84%E7%A7%8D%E5%87%BD%E6%95%B0"><span class="nav-number">9.1.</span> <span class="nav-text">各种函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pbds"><span class="nav-number">9.2.</span> <span class="nav-text">pbds</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E4%BB%A4%E9%9B%86%E4%BC%98%E5%8C%96"><span class="nav-number">9.3.</span> <span class="nav-text">指令集优化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E5%90%8C%E6%AD%A5"><span class="nav-number">9.4.</span> <span class="nav-text">关同步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E8%AF%BB-1"><span class="nav-number">9.5.</span> <span class="nav-text">快读</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#int128%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA"><span class="nav-number">9.6.</span> <span class="nav-text">__int128输入输出</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%8F%E6%9C%BA"><span class="nav-number">9.7.</span> <span class="nav-text">随机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%99%E9%80%86%E5%85%83%E6%B1%82%E6%A6%82%E7%8E%87"><span class="nav-number">9.8.</span> <span class="nav-text">给逆元求概率</span></a></li></ol></li></ol>
    
    </div>
  </aside>
 </section>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/Friends" class="mobile-nav-link">Friends</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>


  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2021 V1n All Rights Reserved.
        
            <span id="busuanzi_container_site_uv">
              本站访客数<span id="busuanzi_value_site_uv"></span>人次  
              本站总访问量<span id="busuanzi_value_site_pv"></span>次
            </span>
          
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>


<script src="/js/bootstrap.js"></script>


<script src="/js/main.js"></script>








  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script>
</body>
</html>
